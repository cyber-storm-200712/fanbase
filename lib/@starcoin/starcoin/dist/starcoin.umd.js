!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("bech32"),require("@ethersproject/bytes"),require("ethereumjs-util"),require("@starcoin/stc-ed25519"),require("js-sha3"),require("is-hexadecimal"),require("is-decimal"),require("is-alphanumerical"),require("is-alphabetical"),require("is-whitespace-character"),require("@ethersproject/logger"),require("lodash"),require("@ethersproject/bignumber"),require("@ethersproject/properties"),require("@ethersproject/web"),require("@ethersproject/basex"),require("@ethersproject/sha2"),require("ws"),require("read-bigint")):"function"==typeof define&&define.amd?define(["exports","bech32","@ethersproject/bytes","ethereumjs-util","@starcoin/stc-ed25519","js-sha3","is-hexadecimal","is-decimal","is-alphanumerical","is-alphabetical","is-whitespace-character","@ethersproject/logger","lodash","@ethersproject/bignumber","@ethersproject/properties","@ethersproject/web","@ethersproject/basex","@ethersproject/sha2","ws","read-bigint"],r):r((e=e||self).starcoin={},e.bech32,e.bytes,e.ethereumjsUtil,e.ed,e.jsSha3,e.isHexadecimal,e.isDecimal,e.isAlphanumerical,e.isAlphabetical,e.isWhitespaceCharacter,e.logger$9,e.lodash,e.bignumber,e.properties$1,e.web,0,0,e.ws,e.readBigint)}(this,function(e,r,t,n,i,o,a,s,u,c,l,f,h,d,p,v,m,g,y,_){function w(e,r){for(var t=0;t<r.length;t++){var n=r[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function z(e,r,t){return r&&w(e.prototype,r),t&&w(e,t),e}function b(){return(b=Object.assign||function(e){for(var r=1;r<arguments.length;r++){var t=arguments[r];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}return e}).apply(this,arguments)}function k(e,r){e.prototype=Object.create(r.prototype),e.prototype.constructor=e,(Object.setPrototypeOf||function(e,r){return e.__proto__=r,e})(e,r)}function P(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function E(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}a=a&&Object.prototype.hasOwnProperty.call(a,"default")?a.default:a,s=s&&Object.prototype.hasOwnProperty.call(s,"default")?s.default:s,u=u&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u,c=c&&Object.prototype.hasOwnProperty.call(c,"default")?c.default:c,l=l&&Object.prototype.hasOwnProperty.call(l,"default")?l.default:l,y=y&&Object.prototype.hasOwnProperty.call(y,"default")?y.default:y;var T={SINGLE:0,MULTI:1};function x(e){var r=e.address+"::"+e.module+"::"+e.name;if(e.type_params&&e.type_params.length>0){r=(r=r.concat("<")).concat(I(e.type_params[0]));for(var t,n=function(e,r){var t;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(t=function(e,r){if(e){if("string"==typeof e)return E(e,void 0);var t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t&&e.constructor&&(t=e.constructor.name),"Map"===t||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?E(e,void 0):void 0}}(e))){t&&(e=t);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(t=e[Symbol.iterator]()).next.bind(t)}(e.type_params.slice(1));!(t=n()).done;){var i=t.value;r=r.concat(",").concat(I(i))}r=r.concat(">")}return r}function I(e){if("string"==typeof e)return e.toLowerCase();if("object"==typeof e){if(void 0!==e.Vector)return"vector<"+I(e.Vector)+">";if(void 0!==e.Struct)return x(e.Struct)}}var B="Executed",U="OutOfGas",N="MiscellaneousError";function S(e){return"string"!=typeof e?e.address+"::"+e.module+"::"+e.functionName:e}function A(e){if("string"!=typeof e)return e;var r=e.split("::",3);if(3!==r.length)throw new Error("cannot parse "+e+" into FunctionId");return{address:r[0],module:r[1],functionName:r[2]}}var O={__proto__:null,accountType:T,formatStructTag:x,formatTypeTag:I,TransactionVMStatus_Executed:B,TransactionVMStatus_OutOfGas:U,TransactionVMStatus_MiscellaneousError:N,formatFunctionId:S,parseFunctionId:A},V=function(){function e(e){this.buffer=new ArrayBuffer(e.length),new Uint8Array(this.buffer).set(e,0),this.offset=0}var r=e.prototype;return r.read=function(e){var r=this.buffer.slice(this.offset,this.offset+e);return this.offset+=e,r},r.deserializeStr=function(){var r=this.deserializeBytes();return e.textDecoder.decode(r)},r.deserializeBytes=function(){var e=this.deserializeLen();if(e<0)throw new Error("Length of a bytes array can't be negative");return new Uint8Array(this.read(e))},r.deserializeBool=function(){return 1==new Uint8Array(this.read(1))[0]},r.deserializeUnit=function(){return null},r.deserializeU8=function(){return new DataView(this.read(1)).getUint8(0)},r.deserializeU16=function(){return new DataView(this.read(2)).getUint16(0,!0)},r.deserializeU32=function(){return new DataView(this.read(4)).getUint32(0,!0)},r.deserializeU64=function(){var r=this.deserializeU32(),t=this.deserializeU32();return BigInt(t)<<e.BIG_32|BigInt(r)},r.deserializeU128=function(){var r=this.deserializeU64(),t=this.deserializeU64();return BigInt(t)<<e.BIG_64|BigInt(r)},r.deserializeI8=function(){return new DataView(this.read(1)).getInt8(0)},r.deserializeI16=function(){return new DataView(this.read(2)).getInt16(0,!0)},r.deserializeI32=function(){return new DataView(this.read(4)).getInt32(0,!0)},r.deserializeI64=function(){var r=this.deserializeI32(),t=this.deserializeI32();return BigInt(t)<<e.BIG_32|BigInt(r)},r.deserializeI128=function(){var r=this.deserializeI64(),t=this.deserializeI64();return BigInt(t)<<e.BIG_64|BigInt(r)},r.deserializeOptionTag=function(){return this.deserializeBool()},r.getBufferOffset=function(){return this.offset},r.deserializeChar=function(){throw new Error("Method deserializeChar not implemented.")},r.deserializeF32=function(){return new DataView(this.read(4)).getFloat32(0,!0)},r.deserializeF64=function(){return new DataView(this.read(8)).getFloat64(0,!0)},e}();V.BIG_32=BigInt(32),V.BIG_64=BigInt(64),V.textDecoder=new TextDecoder;var R=function(e){function r(r){return e.call(this,r)||this}k(r,e);var t=r.prototype;return t.deserializeUleb128AsU32=function(){for(var e=0,t=0;t<32;t+=7){var n=this.deserializeU8(),i=127&n;if((e|=i<<t)<0||e>r.MAX_UINT_32)throw new Error("Overflow while parsing uleb128-encoded uint32 value");if(i==n){if(t>0&&0==i)throw new Error("Invalid uleb128 number (unexpected zero digit)");return e}}throw new Error("Overflow while parsing uleb128-encoded uint32 value")},t.deserializeLen=function(){return this.deserializeUleb128AsU32()},t.deserializeVariantIndex=function(){return this.deserializeUleb128AsU32()},t.checkThatKeySlicesAreIncreasing=function(e,r){},r}(V);R.MAX_UINT_32=Math.pow(2,32)-1;var j=function(){function e(){this.buffer=new ArrayBuffer(64),this.offset=0}var r=e.prototype;return r.ensureBufferWillHandleSize=function(e){for(;this.buffer.byteLength<this.offset+e;){var r=new ArrayBuffer(2*this.buffer.byteLength);new Uint8Array(r).set(new Uint8Array(this.buffer)),this.buffer=r}},r.serialize=function(e){this.ensureBufferWillHandleSize(e.length),new Uint8Array(this.buffer,this.offset).set(e),this.offset+=e.length},r.serializeStr=function(r){this.serializeBytes(e.textEncoder.encode(r))},r.serializeBytes=function(e){this.serializeLen(e.length),this.serialize(e)},r.serializeBool=function(e){this.serialize(new Uint8Array([e?1:0]))},r.serializeUnit=function(e){},r.serializeWithFunction=function(e,r,t){this.ensureBufferWillHandleSize(r);var n=new DataView(this.buffer,this.offset);e.apply(n,[0,t,!0]),this.offset+=r},r.serializeU8=function(e){this.serialize(new Uint8Array([e]))},r.serializeU16=function(e){this.serializeWithFunction(DataView.prototype.setUint16,2,e)},r.serializeU32=function(e){this.serializeWithFunction(DataView.prototype.setUint32,4,e)},r.serializeU64=function(r){var t=BigInt(r)&e.BIG_32Fs,n=BigInt(r)>>e.BIG_32;this.serializeU32(Number(t)),this.serializeU32(Number(n))},r.serializeU128=function(r){var t=BigInt(r)&e.BIG_64Fs,n=BigInt(r)>>e.BIG_64;this.serializeU64(t),this.serializeU64(n)},r.serializeI8=function(e){this.ensureBufferWillHandleSize(1),new DataView(this.buffer,this.offset).setInt8(0,e),this.offset+=1},r.serializeI16=function(e){this.ensureBufferWillHandleSize(2),new DataView(this.buffer,this.offset).setInt16(0,e,!0),this.offset+=2},r.serializeI32=function(e){this.ensureBufferWillHandleSize(4),new DataView(this.buffer,this.offset).setInt32(0,e,!0),this.offset+=4},r.serializeI64=function(r){var t=BigInt(r)&e.BIG_32Fs,n=BigInt(r)>>e.BIG_32;this.serializeI32(Number(t)),this.serializeI32(Number(n))},r.serializeI128=function(r){var t=BigInt(r)&e.BIG_64Fs,n=BigInt(r)>>e.BIG_64;this.serializeI64(t),this.serializeI64(n)},r.serializeOptionTag=function(e){this.serializeBool(e)},r.getBufferOffset=function(){return this.offset},r.getBytes=function(){return new Uint8Array(this.buffer).slice(0,this.offset)},r.serializeChar=function(e){throw new Error("Method serializeChar not implemented.")},r.serializeF32=function(e){this.ensureBufferWillHandleSize(4),new DataView(this.buffer,this.offset).setFloat32(0,e,!0),this.offset+=4},r.serializeF64=function(e){this.ensureBufferWillHandleSize(8),new DataView(this.buffer,this.offset).setFloat64(0,e,!0),this.offset+=8},e}();j.BIG_32=BigInt(32),j.BIG_64=BigInt(64),j.BIG_32Fs=BigInt("4294967295"),j.BIG_64Fs=BigInt("18446744073709551615"),j.textEncoder=new TextEncoder;var C=function(e){function r(){return e.call(this)||this}k(r,e);var t=r.prototype;return t.serializeU32AsUleb128=function(e){for(var r=[];e>>>7!=0;)r.push(127&e|128),e>>>=7;r.push(e),this.serialize(new Uint8Array(r))},t.serializeLen=function(e){this.serializeU32AsUleb128(e)},t.serializeVariantIndex=function(e){this.serializeU32AsUleb128(e)},t.sortMapEntries=function(e){},r}(j),L={__proto__:null,BcsDeserializer:R,BcsSerializer:C};function M(e){return("00000000000000000000000000000000"+(e>>>0).toString(2)).slice(-32)}function H(e){return Number.parseInt(Number.parseInt(e,2).toString(10),10)}function D(e){var r=M(e).match(/.{1,8}/g);return Uint8Array.from(r.map(function(e){return H(e)}))}function F(e){var r=[];return e.forEach(function(e){return r.push(M(e).slice(-8))}),H(r.join(""))}function q(e,r){if(r>31||r<0)throw new Error("mask: invalid idx at "+r+", should be between 0 and 31");return e|1<<32-r-1}function K(e,r){if(r>31||r<0)throw new Error("mask: invalid idx at "+r+", should be between 0 and 31");return(e>>32-r-1)%2!=0}var W={__proto__:null,dec2bin:M,bin2dec:H,dec2uint8array:D,uint8array2dec:F,setBit:q,isSetBit:K},G=function(){function e(e,r){this.field0=e,this.field1=r}return e.prototype.serialize=function(e){this.field0.serialize(e),this.field1.serialize(e)},e.deserialize=function(r){return new e(J.deserialize(r),ne.deserialize(r))},e}(),J=function(){function e(e){this.value=e}return e.prototype.serialize=function(e){pr.serializeArray16U8Array(this.value,e)},e.deserialize=function(r){return new e(pr.deserializeArray16U8Array(r))},e}();J.LENGTH=16;var X=function(){function e(e,r,t,n,i,o,a){this.authentication_key=e,this.withdrawal_capability=r,this.key_rotation_capability=t,this.withdraw_events=n,this.deposit_events=i,this.accept_token_events=o,this.sequence_number=a}return e.prototype.serialize=function(e){pr.serializeVectorU8(this.authentication_key,e),pr.serializeOptionWithdrawCapabilityResource(this.withdrawal_capability,e),pr.serializeOptionKeyRotationCapabilityResource(this.key_rotation_capability,e),this.withdraw_events.serialize(e),this.deposit_events.serialize(e),this.accept_token_events.serialize(e),e.serializeU64(this.sequence_number)},e.deserialize=function(r){return new e(pr.deserializeVectorU8(r),pr.deserializeOptionWithdrawCapabilityResource(r),pr.deserializeOptionKeyRotationCapabilityResource(r),he.deserialize(r),he.deserialize(r),he.deserialize(r),r.deserializeU64())},e}(),Q=function(){function e(e,r){this.name=e,this.type_tag=r}return e.prototype.serialize=function(e){e.serializeStr(this.name),this.type_tag.serialize(e)},e.deserialize=function(r){return new e(r.deserializeStr(),Ze.deserialize(r))},e}(),$=function(){function e(e){this.value=e}return e.prototype.serialize=function(e){e.serializeBytes(this.value)},e.deserialize=function(r){return new e(r.deserializeBytes())},e}(),Y=function(){function e(e,r,t,n,i,o,a,s){this.parent_hash=e,this.timestamp=r,this.author=t,this.author_auth_key=n,this.uncles=i,this.number=o,this.chain_id=a,this.parent_gas_used=s}return e.prototype.serialize=function(e){this.parent_hash.serialize(e),e.serializeU64(this.timestamp),this.author.serialize(e),pr.serializeOptionAuthenticationKey(this.author_auth_key,e),e.serializeU64(this.uncles),e.serializeU64(this.number),this.chain_id.serialize(e),e.serializeU64(this.parent_gas_used)},e.deserialize=function(r){return new e(pe.deserialize(r),r.deserializeU64(),J.deserialize(r),pr.deserializeOptionAuthenticationKey(r),r.deserializeU64(),r.deserializeU64(),Z.deserialize(r),r.deserializeU64())},e}(),Z=function(){function e(e){this.id=e}return e.prototype.serialize=function(e){e.serializeU8(this.id)},e.deserialize=function(r){return new e(r.deserializeU8())},e}(),ee=function(){function e(){}return e.deserialize=function(e){var r=e.deserializeVariantIndex();switch(r){case 0:return re.load(e);default:throw new Error("Unknown variant index for ContractEvent: "+r)}},e}(),re=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(0),this.value.serialize(e)},r.load=function(e){return new r(te.deserialize(e))},r}(ee),te=function(){function e(e,r,t,n){this.key=e,this.sequence_number=r,this.type_tag=t,this.event_data=n}return e.prototype.serialize=function(e){this.key.serialize(e),e.serializeU64(this.sequence_number),this.type_tag.serialize(e),e.serializeBytes(this.event_data)},e.deserialize=function(r){return new e(de.deserialize(r),r.deserializeU64(),Ze.deserialize(r),r.deserializeBytes())},e}(),ne=function(){function e(){}return e.deserialize=function(e){var r=e.deserializeVariantIndex();switch(r){case 0:return ie.load(e);case 1:return oe.load(e);default:throw new Error("Unknown variant index for DataPath: "+r)}},e}(),ie=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(0),this.value.serialize(e)},r.load=function(e){return new r(ve.deserialize(e))},r}(ne),oe=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(1),this.value.serialize(e)},r.load=function(e){return new r(Ae.deserialize(e))},r}(ne),ae=function(){function e(){}return e.deserialize=function(e){var r=e.deserializeVariantIndex();switch(r){case 0:return se.load(e);case 1:return ue.load(e);default:throw new Error("Unknown variant index for DataType: "+r)}},e}(),se=function(e){function r(){return e.call(this)||this}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(0)},r.load=function(e){return new r},r}(ae),ue=function(e){function r(){return e.call(this)||this}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(1)},r.load=function(e){return new r},r}(ae),ce=function(){function e(e){this.value=e}return e.prototype.serialize=function(e){e.serializeBytes(this.value)},e.deserialize=function(r){return new e(r.deserializeBytes())},e}(),le=function(){function e(e){this.value=e}return e.prototype.serialize=function(e){e.serializeBytes(this.value)},e.deserialize=function(r){return new e(r.deserializeBytes())},e}(),fe=function(){function e(e){this.value=e}return e.prototype.serialize=function(e){e.serializeBytes(this.value)},e.deserialize=function(r){return new e(r.deserializeBytes())},e}(),he=function(){function e(e,r){this.count=e,this.key=r}return e.prototype.serialize=function(e){e.serializeU64(this.count),this.key.serialize(e)},e.deserialize=function(r){return new e(r.deserializeU64(),de.deserialize(r))},e}(),de=function(){function e(e){this.value=e}return e.prototype.serialize=function(e){e.serializeBytes(this.value)},e.deserialize=function(r){return new e(r.deserializeBytes())},e}(),pe=function(){function e(e){this.value=e}return e.prototype.serialize=function(e){e.serializeBytes(this.value)},e.deserialize=function(r){return new e(r.deserializeBytes())},e}(),ve=function(){function e(e){this.value=e}return e.prototype.serialize=function(e){e.serializeStr(this.value)},e.deserialize=function(r){return new e(r.deserializeStr())},e}(),me=function(){function e(e){this.account_address=e}return e.prototype.serialize=function(e){this.account_address.serialize(e)},e.deserialize=function(r){return new e(J.deserialize(r))},e}(),ge=function(){function e(e){this.code=e}return e.prototype.serialize=function(e){e.serializeBytes(this.code)},e.deserialize=function(r){return new e(r.deserializeBytes())},e}(),ye=function(){function e(e,r){this.address=e,this.name=r}return e.prototype.serialize=function(e){this.address.serialize(e),this.name.serialize(e)},e.deserialize=function(r){return new e(J.deserialize(r),ve.deserialize(r))},e}(),_e=function(){function e(e){this.value=e}return e.prototype.serialize=function(e){e.serializeBytes(this.value)},e.deserialize=function(r){return new e(r.deserializeBytes())},e}(),we=function(){function e(e,r){this.public_keys=e,this.threshold=r;var t=e.length;if(0===r||t<r)throw new Error("Key or signature material deserializes, but is otherwise not valid");if(t>32)throw new Error("Key, threshold or signature material does not have the expected size")}var r=e.prototype;return r.serialize=function(e){e.serializeBytes(this.value())},e.deserialize=function(r){for(var t=r.deserializeBytes(),n=[],i=(t.length-1)/32,o=0;o<i;o++){var a=32*o;n.push(new le(t.slice(a,a+32)))}return new e(n,new DataView(t.slice(-1).buffer,0).getUint8(0))},r.value=function(){var e=[];this.public_keys.forEach(function(r){e.push(r.value)});var r=new Uint8Array(1);return r[0]=this.threshold,t.concat([].concat(e,r))},e}(),ze=function(){function e(e,r){this.signatures=e,this.bitmap=r}e.build=function(r){var t=r.length;if(0===t||t>32)throw new Error("Key or signature material deserializes, but is otherwise not valid");var n=r.sort(function(e,r){return e[1]>r[1]?1:-1}),i=[],o=0;return n.forEach(function(e,r){if(console.log(e,r),e[1]>=32)throw new Error("BitVec errors in accountable multi-sig schemes: Signature index is out of range");if(K(o,e[1]))throw new Error("BitVec errors in accountable multi-sig schemes: Duplicate signature index");i.push(e[0]),o=q(o,e[1])}),new e(i,o)};var r=e.prototype;return r.serialize=function(e){e.serializeBytes(this.value())},e.deserialize=function(r){for(var t=r.deserializeBytes(),n=[],i=(t.length-4)/64,o=0;o<i;o++){var a=64*o;n.push(new fe(t.slice(a,a+64)))}return new e(n,F(t.slice(-4)))},r.value=function(){var e=[];this.signatures.forEach(function(r){e.push(r.value)});var r=D(this.bitmap);return t.concat([].concat(e,r))},e}(),be=function(){function e(e,r){this.signature=e,this.threshold=r}var r=e.prototype;return r.signatures=function(){var e=this.signature.bitmap,r=[],t=0;return this.signature.signatures.forEach(function(n,i){for(;!K(e,t);)t+=1;r.push([n,t]),t+=1}),r},e.merge=function(r){if(0===r.length)throw new Error("MultiEd25519SignatureShard shards is empty");var t=r[0].threshold,n=[];return r.forEach(function(e){if(e.threshold!==t)throw new Error("MultiEd25519SignatureShard shards threshold not same");n.push.apply(n,e.signatures())}),new e(ze.build(n),t)},r.is_enough=function(){return this.signature.signatures.length>=this.threshold},e}(),ke=function(){function e(e,r,t){this.public_keys=e,this.threshold=r,this.private_keys=t;var n=e.length,i=Object.keys(t).length;if(0===r||0===i||n<r)throw new Error("Key or signature material deserializes, but is otherwise not valid");if(i>32||n>32)throw new Error("Key, threshold or signature material does not have the expected size")}var r=e.prototype;return r.serialize=function(e){var r=this;e.serializeU8(this.public_keys.length),e.serializeU8(this.threshold),e.serializeU8(this.len()),this.public_keys.forEach(function(r){r.serialize(e)}),Object.keys(this.private_keys).forEach(function(t){e.serializeU8(Number.parseInt(t,10)),r.private_keys[t].serialize(e)})},e.deserialize=function(r){for(var t=r.deserializeU8(),n=r.deserializeU8(),i=r.deserializeU8(),o=[],a=0;a<t;a++)o.push(le.deserialize(r));for(var s=0;s<i;s++){var u=r.deserializeU8(),c=ce.deserialize(r);o[u]=c}return new e(o,n,[])},r.publicKey=function(){return new we(this.public_keys,this.threshold)},r.privateKeys=function(){return Object.values(this.private_keys)},r.privateKey=function(){var e=new Uint8Array(3);e[0]=this.public_keys.length,e[1]=this.threshold,e[2]=this.len();var r=[];this.public_keys.forEach(function(e){r.push(e.value)});var n=[];return Object.values(this.private_keys).forEach(function(e){n.push(e.value)}),t.concat([e].concat(r,n))},r.len=function(){return Object.values(this.private_keys).length},r.isEmpty=function(){return 0===this.len()},e}(),Pe=function(){function e(e,r,t){this.package_address=e,this.modules=r,this.init_script=t}return e.prototype.serialize=function(e){this.package_address.serialize(e),pr.serializeVectorModule(this.modules,e),pr.serializeOptionScriptFunction(this.init_script,e)},e.deserialize=function(r){return new e(J.deserialize(r),pr.deserializeVectorModule(r),pr.deserializeOptionScriptFunction(r))},e}(),Ee=function(){function e(e,r,t,n,i,o,a,s){this.sender=e,this.sequence_number=r,this.payload=t,this.max_gas_amount=n,this.gas_unit_price=i,this.gas_token_code=o,this.expiration_timestamp_secs=a,this.chain_id=s}return e.prototype.serialize=function(e){this.sender.serialize(e),e.serializeU64(this.sequence_number),this.payload.serialize(e),e.serializeU64(this.max_gas_amount),e.serializeU64(this.gas_unit_price),e.serializeStr(this.gas_token_code),e.serializeU64(this.expiration_timestamp_secs),this.chain_id.serialize(e)},e.deserialize=function(r){return new e(J.deserialize(r),r.deserializeU64(),Ge.deserialize(r),r.deserializeU64(),r.deserializeU64(),r.deserializeStr(),r.deserializeU64(),Z.deserialize(r))},e}(),Te=function(){function e(e,r,t){this.code=e,this.ty_args=r,this.args=t}return e.prototype.serialize=function(e){e.serializeBytes(this.code),pr.serializeVectorTypeTag(this.ty_args,e),pr.serializeVectorBytes(this.args,e)},e.deserialize=function(r){return new e(r.deserializeBytes(),pr.deserializeVectorTypeTag(r),pr.deserializeVectorBytes(r))},e}(),xe=function(){function e(){}return e.deserialize=function(e){var r=e.deserializeVariantIndex();switch(r){case 0:return Ie.load(e);case 1:return Be.load(e);default:throw new Error("Unknown variant index for ScriptABI: "+r)}},e}(),Ie=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(0),this.value.serialize(e)},r.load=function(e){return new r($e.deserialize(e))},r}(xe),Be=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(1),this.value.serialize(e)},r.load=function(e){return new r(Ne.deserialize(e))},r}(xe),Ue=function(){function e(e,r,t,n){this.module=e,this.func=r,this.ty_args=t,this.args=n}return e.prototype.serialize=function(e){this.module.serialize(e),this.func.serialize(e),pr.serializeVectorTypeTag(this.ty_args,e),pr.serializeVectorBytes(this.args,e)},e.deserialize=function(r){return new e(ye.deserialize(r),ve.deserialize(r),pr.deserializeVectorTypeTag(r),pr.deserializeVectorBytes(r))},e}(),Ne=function(){function e(e,r,t,n,i){this.name=e,this.module_name=r,this.doc=t,this.ty_args=n,this.args=i}return e.prototype.serialize=function(e){e.serializeStr(this.name),this.module_name.serialize(e),e.serializeStr(this.doc),pr.serializeVectorTypeArgumentAbi(this.ty_args,e),pr.serializeVectorArgumentAbi(this.args,e)},e.deserialize=function(r){return new e(r.deserializeStr(),ye.deserialize(r),r.deserializeStr(),pr.deserializeVectorTypeArgumentAbi(r),pr.deserializeVectorArgumentAbi(r))},e}(),Se=function(){function e(e,r){this.raw_txn=e,this.authenticator=r}return e.prototype.serialize=function(e){this.raw_txn.serialize(e),this.authenticator.serialize(e)},e.deserialize=function(r){return new e(Ee.deserialize(r),qe.deserialize(r))},e.ed25519=function(r,t,n){return new e(r,new Ke(t,n))},e.multi_ed25519=function(r,t,n){return new e(r,new We(t,n))},e}(),Ae=function(){function e(e,r,t,n){this.address=e,this.module=r,this.name=t,this.type_params=n}return e.prototype.serialize=function(e){this.address.serialize(e),this.module.serialize(e),this.name.serialize(e),pr.serializeVectorTypeTag(this.type_params,e)},e.deserialize=function(r){return new e(J.deserialize(r),ve.deserialize(r),ve.deserialize(r),pr.deserializeVectorTypeTag(r))},e}(),Oe=function(){function e(){}return e.deserialize=function(e){var r=e.deserializeVariantIndex();switch(r){case 0:return Ve.load(e);case 1:return Re.load(e);default:throw new Error("Unknown variant index for Transaction: "+r)}},e}(),Ve=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(0),this.value.serialize(e)},r.load=function(e){return new r(Se.deserialize(e))},r}(Oe),Re=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(1),this.value.serialize(e)},r.load=function(e){return new r(Y.deserialize(e))},r}(Oe),je=function(){function e(){}return e.deserialize=function(e){var r=e.deserializeVariantIndex();switch(r){case 0:return Ce.load(e);case 1:return Le.load(e);case 2:return Me.load(e);case 3:return He.load(e);case 4:return De.load(e);case 5:return Fe.load(e);default:throw new Error("Unknown variant index for TransactionArgument: "+r)}},e}(),Ce=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(0),e.serializeU8(this.value)},r.load=function(e){return new r(e.deserializeU8())},r}(je),Le=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(1),e.serializeU64(this.value)},r.load=function(e){return new r(e.deserializeU64())},r}(je),Me=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(2),e.serializeU128(this.value)},r.load=function(e){return new r(e.deserializeU128())},r}(je),He=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(3),this.value.serialize(e)},r.load=function(e){return new r(J.deserialize(e))},r}(je),De=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(4),e.serializeBytes(this.value)},r.load=function(e){return new r(e.deserializeBytes())},r}(je),Fe=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(5),e.serializeBool(this.value)},r.load=function(e){return new r(e.deserializeBool())},r}(je),qe=function(){function e(){}return e.deserialize=function(e){var r=e.deserializeVariantIndex();switch(r){case 0:return Ke.load(e);case 1:return We.load(e);default:throw new Error("Unknown variant index for TransactionAuthenticator: "+r)}},e}(),Ke=function(e){function r(r,t){var n;return(n=e.call(this)||this).public_key=r,n.signature=t,n}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(0),this.public_key.serialize(e),this.signature.serialize(e)},r.load=function(e){return new r(le.deserialize(e),fe.deserialize(e))},r}(qe),We=function(e){function r(r,t){var n;return(n=e.call(this)||this).public_key=r,n.signature=t,n}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(1),this.public_key.serialize(e),this.signature.serialize(e)},r.load=function(e){return new r(we.deserialize(e),ze.deserialize(e))},r}(qe),Ge=function(){function e(){}return e.deserialize=function(e){var r=e.deserializeVariantIndex();switch(r){case 0:return Je.load(e);case 1:return Xe.load(e);case 2:return Qe.load(e);default:throw new Error("Unknown variant index for TransactionPayload: "+r)}},e}(),Je=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(0),this.value.serialize(e)},r.load=function(e){return new r(Te.deserialize(e))},r}(Ge),Xe=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(1),this.value.serialize(e)},r.load=function(e){return new r(Pe.deserialize(e))},r}(Ge),Qe=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(2),this.value.serialize(e)},r.load=function(e){return new r(Ue.deserialize(e))},r}(Ge),$e=function(){function e(e,r,t,n,i){this.name=e,this.doc=r,this.code=t,this.ty_args=n,this.args=i}return e.prototype.serialize=function(e){e.serializeStr(this.name),e.serializeStr(this.doc),e.serializeBytes(this.code),pr.serializeVectorTypeArgumentAbi(this.ty_args,e),pr.serializeVectorArgumentAbi(this.args,e)},e.deserialize=function(r){return new e(r.deserializeStr(),r.deserializeStr(),r.deserializeBytes(),pr.deserializeVectorTypeArgumentAbi(r),pr.deserializeVectorArgumentAbi(r))},e}(),Ye=function(){function e(e){this.name=e}return e.prototype.serialize=function(e){e.serializeStr(this.name)},e.deserialize=function(r){return new e(r.deserializeStr())},e}(),Ze=function(){function e(){}return e.deserialize=function(e){var r=e.deserializeVariantIndex();switch(r){case 0:return er.load(e);case 1:return rr.load(e);case 2:return tr.load(e);case 3:return nr.load(e);case 4:return ir.load(e);case 5:return or.load(e);case 6:return ar.load(e);case 7:return sr.load(e);default:throw new Error("Unknown variant index for TypeTag: "+r)}},e}(),er=function(e){function r(){return e.call(this)||this}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(0)},r.load=function(e){return new r},r}(Ze),rr=function(e){function r(){return e.call(this)||this}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(1)},r.load=function(e){return new r},r}(Ze),tr=function(e){function r(){return e.call(this)||this}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(2)},r.load=function(e){return new r},r}(Ze),nr=function(e){function r(){return e.call(this)||this}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(3)},r.load=function(e){return new r},r}(Ze),ir=function(e){function r(){return e.call(this)||this}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(4)},r.load=function(e){return new r},r}(Ze),or=function(e){function r(){return e.call(this)||this}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(5)},r.load=function(e){return new r},r}(Ze),ar=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(6),this.value.serialize(e)},r.load=function(e){return new r(Ze.deserialize(e))},r}(Ze),sr=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(7),this.value.serialize(e)},r.load=function(e){return new r(Ae.deserialize(e))},r}(Ze),ur=function(){function e(e){this.account_address=e}return e.prototype.serialize=function(e){this.account_address.serialize(e)},e.deserialize=function(r){return new e(J.deserialize(r))},e}(),cr=function(){function e(){}return e.deserialize=function(e){var r=e.deserializeVariantIndex();switch(r){case 0:return lr.load(e);case 1:return fr.load(e);default:throw new Error("Unknown variant index for WriteOp: "+r)}},e}(),lr=function(e){function r(){return e.call(this)||this}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(0)},r.load=function(e){return new r},r}(cr),fr=function(e){function r(r){var t;return(t=e.call(this)||this).value=r,t}return k(r,e),r.prototype.serialize=function(e){e.serializeVariantIndex(1),e.serializeBytes(this.value)},r.load=function(e){return new r(e.deserializeBytes())},r}(cr),hr=function(){function e(e){this.value=e}return e.prototype.serialize=function(e){this.value.serialize(e)},e.deserialize=function(r){return new e(dr.deserialize(r))},e}(),dr=function(){function e(e){this.write_set=e}return e.prototype.serialize=function(e){pr.serializeVectorTuple2AccessPathWriteOp(this.write_set,e)},e.deserialize=function(r){return new e(pr.deserializeVectorTuple2AccessPathWriteOp(r))},e}(),pr=function(){function e(){}return e.serializeArray16U8Array=function(e,r){e.forEach(function(e){r.serializeU8(e[0])})},e.deserializeArray16U8Array=function(e){for(var r=[],t=0;t<16;t++)r.push([e.deserializeU8()]);return r},e.serializeOptionAuthenticationKey=function(e,r){e?(r.serializeOptionTag(!0),e.serialize(r)):r.serializeOptionTag(!1)},e.deserializeOptionAuthenticationKey=function(e){return e.deserializeOptionTag()?$.deserialize(e):null},e.serializeOptionKeyRotationCapabilityResource=function(e,r){e?(r.serializeOptionTag(!0),e.serialize(r)):r.serializeOptionTag(!1)},e.deserializeOptionKeyRotationCapabilityResource=function(e){return e.deserializeOptionTag()?me.deserialize(e):null},e.serializeOptionScriptFunction=function(e,r){e?(r.serializeOptionTag(!0),e.serialize(r)):r.serializeOptionTag(!1)},e.deserializeOptionScriptFunction=function(e){return e.deserializeOptionTag()?Ue.deserialize(e):null},e.serializeOptionWithdrawCapabilityResource=function(e,r){e?(r.serializeOptionTag(!0),e.serialize(r)):r.serializeOptionTag(!1)},e.deserializeOptionWithdrawCapabilityResource=function(e){return e.deserializeOptionTag()?ur.deserialize(e):null},e.serializeTuple2AccessPathWriteOp=function(e,r){e[0].serialize(r),e[1].serialize(r)},e.deserializeTuple2AccessPathWriteOp=function(e){return[G.deserialize(e),cr.deserialize(e)]},e.serializeVectorArgumentAbi=function(e,r){r.serializeLen(e.length),e.forEach(function(e){e.serialize(r)})},e.deserializeVectorArgumentAbi=function(e){for(var r=e.deserializeLen(),t=[],n=0;n<r;n++)t.push(Q.deserialize(e));return t},e.serializeVectorModule=function(e,r){r.serializeLen(e.length),e.forEach(function(e){e.serialize(r)})},e.deserializeVectorModule=function(e){for(var r=e.deserializeLen(),t=[],n=0;n<r;n++)t.push(ge.deserialize(e));return t},e.serializeVectorTypeArgumentAbi=function(e,r){r.serializeLen(e.length),e.forEach(function(e){e.serialize(r)})},e.deserializeVectorTypeArgumentAbi=function(e){for(var r=e.deserializeLen(),t=[],n=0;n<r;n++)t.push(Ye.deserialize(e));return t},e.serializeVectorTypeTag=function(e,r){r.serializeLen(e.length),e.forEach(function(e){e.serialize(r)})},e.deserializeVectorTypeTag=function(e){for(var r=e.deserializeLen(),t=[],n=0;n<r;n++)t.push(Ze.deserialize(e));return t},e.serializeVectorBytes=function(e,r){r.serializeLen(e.length),e.forEach(function(e){r.serializeBytes(e)})},e.deserializeVectorBytes=function(e){for(var r=e.deserializeLen(),t=[],n=0;n<r;n++)t.push(e.deserializeBytes());return t},e.serializeVectorTuple2AccessPathWriteOp=function(r,t){t.serializeLen(r.length),r.forEach(function(r){e.serializeTuple2AccessPathWriteOp(r,t)})},e.deserializeVectorTuple2AccessPathWriteOp=function(r){for(var t=r.deserializeLen(),n=[],i=0;i<t;i++)n.push(e.deserializeTuple2AccessPathWriteOp(r));return n},e.serializeVectorU8=function(e,r){r.serializeLen(e.length),e.forEach(function(e){r.serializeU8(e)})},e.deserializeVectorU8=function(e){for(var r=e.deserializeLen(),t=[],n=0;n<r;n++)t.push(e.deserializeU8());return t},e}(),vr=function(){function e(e){this.value=e}var r=e.prototype;return r.serialize=function(e){e.serializeBytes(this.value)},r.hex=function(){return Buffer.from(this.value).toString("hex")},e}(),mr=function(){function e(e,r){this.accountAddress=e,this.authKey=r}return e.prototype.encode=function(){var e=new C;this.accountAddress.serialize(e);var t=Buffer.concat([Buffer.from(e.getBytes()),Buffer.from(this.authKey.value)]),n=r.bech32.toWords(t),i=[Number("1")].concat(n);return r.bech32.encode("stc",i)},e.decode=function(t){var n=r.bech32.decode(t).words.slice(1),i=Buffer.from(r.bech32.fromWords(n)),o=i.slice(0,J.LENGTH),a=i.slice(J.LENGTH);return new e(J.deserialize(new R(o)),new vr(a))},e}(),gr=function(){function e(e){this.message=e}return e.prototype.serialize=function(e){e.serializeBytes(this.message)},e.deserialize=function(r){return new e(r.deserializeBytes())},e}(),yr=function(){function e(e,r,t,n){this.account=e,this.message=r,this.authenticator=t,this.chain_id=n}return e.prototype.serialize=function(e){this.account.serialize(e),this.message.serialize(e),this.authenticator.serialize(e),this.chain_id.serialize(e)},e.deserialize=function(r){return new e(J.deserialize(r),gr.deserialize(r),qe.deserialize(r),Z.deserialize(r))},e}(),_r={__proto__:null,AccessPath:G,AccountAddress:J,AccountResource:X,ArgumentABI:Q,AuthenticationKey:$,BlockMetadata:Y,ChainId:Z,ContractEvent:ee,ContractEventVariantV0:re,ContractEventV0:te,DataPath:ne,DataPathVariantCode:ie,DataPathVariantResource:oe,DataType:ae,DataTypeVariantCODE:se,DataTypeVariantRESOURCE:ue,Ed25519PrivateKey:ce,Ed25519PublicKey:le,Ed25519Signature:fe,EventHandle:he,EventKey:de,HashValue:pe,Identifier:ve,KeyRotationCapabilityResource:me,Module:ge,ModuleId:ye,MultiEd25519PrivateKey:_e,MultiEd25519PublicKey:we,MultiEd25519Signature:ze,MultiEd25519SignatureShard:be,MultiEd25519KeyShard:ke,Package:Pe,RawUserTransaction:Ee,Script:Te,ScriptABI:xe,ScriptABIVariantTransactionScript:Ie,ScriptABIVariantScriptFunction:Be,ScriptFunction:Ue,ScriptFunctionABI:Ne,SignedUserTransaction:Se,StructTag:Ae,Transaction:Oe,TransactionVariantUserTransaction:Ve,TransactionVariantBlockMetadata:Re,TransactionArgument:je,TransactionArgumentVariantU8:Ce,TransactionArgumentVariantU64:Le,TransactionArgumentVariantU128:Me,TransactionArgumentVariantAddress:He,TransactionArgumentVariantU8Vector:De,TransactionArgumentVariantBool:Fe,TransactionAuthenticator:qe,TransactionAuthenticatorVariantEd25519:Ke,TransactionAuthenticatorVariantMultiEd25519:We,TransactionPayload:Ge,TransactionPayloadVariantScript:Je,TransactionPayloadVariantPackage:Xe,TransactionPayloadVariantScriptFunction:Qe,TransactionScriptABI:$e,TypeArgumentABI:Ye,TypeTag:Ze,TypeTagVariantBool:er,TypeTagVariantU8:rr,TypeTagVariantU64:tr,TypeTagVariantU128:nr,TypeTagVariantAddress:ir,TypeTagVariantSigner:or,TypeTagVariantVector:ar,TypeTagVariantStruct:sr,WithdrawCapabilityResource:ur,WriteOp:cr,WriteOpVariantDeletion:lr,WriteOpVariantValue:fr,WriteSet:hr,WriteSetMut:dr,Helpers:pr,AuthKey:vr,ReceiptIdentifier:mr,SigningMessage:gr,SignedMessage:yr},wr=require("safe-buffer").Buffer,zr=require("js-sha3").sha3_256,br=function(){function e(e){if(e){var r=new Uint8Array(wr.from("STARCOIN::"+e)),t=zr.create();t.update(r),this.salt=new Uint8Array(t.arrayBuffer())}}var r=e.prototype;return r.crypto_hash=function(e){var r=zr.create();return this.salt&&r.update(this.salt),r.update(t.arrayify(e)),n.addHexPrefix(r.hex())},r.get_salt=function(){return this.salt},e}();function kr(e){return new br(e)}function Pr(){return kr("SignedUserTransaction")}function Er(){return kr("RawUserTransaction")}function Tr(){return kr("SigningMessage")}var xr={__proto__:null,createHash:kr,createUserTransactionHasher:Pr,createRawUserTransactionHasher:Er,createSigningMessageHasher:Tr};function Ir(e){return"0x"+Buffer.from(new Uint8Array(e)).toString("hex")}function Br(e,r){e.startsWith("0x")&&(e=e.substring(2)),r?e.length<r&&(e=Ur(e,r)):e.length%2!=0&&(e="0"+e);var t=Buffer.from(e,"hex");return new Uint8Array(t)}function Ur(e,r,t){return new Array(r-e.length+1).join(t||"0")+e}var Nr={__proto__:null,toHexString:Ir,fromHexString:Br,padLeft:Ur,padRight:function(e,r,t){return e+new Array(r-e.length+1).join(t||"0")}},Sr=function(e){try{return Promise.resolve(i.getPublicKey(n.stripHexPrefix(e))).then(n.addHexPrefix)}catch(e){return Promise.reject(e)}};function Ar(e,r){var n=new R(t.arrayify(r));return e.deserialize(n)}function Or(e){var r=new C;return e.serialize(r),Ir(r.getBytes())}function Vr(e){var r,n,i=t.arrayify(e),o=(r=new R(i),Se.deserialize(r));if(o.authenticator instanceof Ke)n={Ed25519:{public_key:t.hexlify(o.authenticator.public_key.value),signature:t.hexlify(o.authenticator.signature.value)}};else{var a=o.authenticator;n={MultiEd25519:{public_key:t.hexlify(a.public_key.value()),signature:t.hexlify(a.signature.value())}}}var s,u=o.raw_txn,c=(s=new C,u.payload.serialize(s),t.hexlify(s.getBytes()));return{transaction_hash:Pr().crypto_hash(i),raw_txn:{sender:Cr(u.sender),sequence_number:u.sequence_number,payload:c,max_gas_amount:u.max_gas_amount,gas_unit_price:u.gas_unit_price,gas_token_code:u.gas_token_code,expiration_timestamp_secs:u.expiration_timestamp_secs,chain_id:u.chain_id.id},authenticator:n}}function Rr(e){var r=new R(t.arrayify(n.addHexPrefix(e)));return Xe.load(r)}function jr(e){var r=Br(e,32);return J.deserialize(new R(r))}function Cr(e){return Ir(e.value.map(function(e){return e[0]}))}function Lr(e){if("Bool"===e)return new er;if("U8"===e)return new rr;if("U128"===e)return new nr;if("U64"===e)return new tr;if("Address"===e)return new ir;if("Signer"===e)return new or;if("Vector"in e)return new ar(Lr(e.Vector));if("Struct"in e)return new sr(Mr(e.Struct));throw new Error("invalid type tag: "+e)}function Mr(e){return new Ae(jr(e.address),new ve(e.module),new ve(e.name),e.type_params?e.type_params.map(function(e){return Lr(e)}):[])}function Hr(e){return{module:e.module.value,name:e.name.value,type_params:e.type_params.map(function(e){return Dr(e)}),address:Cr(e.address)}}function Dr(e){if(e instanceof ir)return"Address";if(e instanceof er)return"Bool";if(e instanceof rr)return"U8";if(e instanceof tr)return"U64";if(e instanceof nr)return"U128";if(e instanceof or)return"Signer";if(e instanceof sr)return{Struct:Hr(e.value)};if(e instanceof ar)return{Vector:Dr(e.value)};throw new TypeError("invalid bcs type tag: "+e)}function Fr(e,r){void 0===r&&(r=T.SINGLE);var i=o.sha3_256.create();i.update(Br(e)),i.update(Br(t.hexlify(r)));var a=i.hex();return n.addHexPrefix(a)}function qr(e,r){void 0===r&&(r=T.SINGLE);var i=o.sha3_256.create();i.update(Br(e)),i.update(Br(t.hexlify(r)));var a=i.hex(),s=a.slice(a.length/2);return n.addHexPrefix(s)}function Kr(e,r){void 0===r&&(r="");var t=jr(e),n=new vr(Buffer.from(r,"hex"));return new mr(t,n).encode()}var Wr={__proto__:null,privateKeyToPublicKey:Sr,bcsDecode:Ar,bcsEncode:Or,decodeSignedUserTransaction:Vr,decodeTransactionPayload:function(e){var r=t.arrayify(e),n=new R(r),i=Ge.deserialize(n);if(i instanceof Je){var o=i.value;return{Script:{code:Ir(o.code),ty_args:o.ty_args.map(function(e){return Dr(e)}),args:o.args.map(function(e){return t.hexlify(e)})}}}if(i instanceof Qe){var a=i.value;return{ScriptFunction:{func:{address:Cr(a.module.address),module:a.module.name.value,functionName:a.func.value},ty_args:a.ty_args.map(function(e){return Dr(e)}),args:a.args.map(function(e){return t.hexlify(e)})}}}if(i instanceof Xe){var s=i.value;return{Package:{package_address:Cr(s.package_address),modules:s.modules.map(function(e){return{code:Ir(e.code)}}),init_script:null===s.init_script?void 0:{func:{address:Cr(s.init_script.module.address),module:s.init_script.module.name.value,functionName:s.init_script.func.value},args:s.init_script.args.map(function(e){return t.hexlify(e)}),ty_args:s.init_script.ty_args.map(function(e){return Dr(e)})}}}}throw new TypeError("cannot decode bcs data "+i)},packageHexToTransactionPayload:Rr,packageHexToTransactionPayloadHex:function(e){return Or(Rr(e))},addressToSCS:jr,addressFromSCS:Cr,typeTagToSCS:Lr,structTagToSCS:Mr,structTagFromSCS:Hr,typeTagFromSCS:Dr,publicKeyToAuthKey:Fr,publicKeyToAddress:qr,encodeReceiptIdentifier:Kr,decodeReceiptIdentifier:function(e){var r=mr.decode(e);return{accountAddress:n.stripHexPrefix(Cr(r.accountAddress)),authKey:r.authKey.hex()}},publicKeyToReceiptIdentifier:function(e){var r=qr(e),t=Fr(e);return Kr(n.stripHexPrefix(r),n.stripHexPrefix(t))},stringToBytes:function(e){var r,t,n=new Array;r=e.length;for(var i=0;i<r;i++)(t=e.charCodeAt(i))>=65536&&t<=1114111?(n.push(t>>18&7|240),n.push(t>>12&63|128),n.push(t>>6&63|128),n.push(63&t|128)):t>=2048&&t<=65535?(n.push(t>>12&15|224),n.push(t>>6&63|128),n.push(63&t|128)):t>=128&&t<=2047?(n.push(t>>6&31|192),n.push(63&t|128)):n.push(255&t);return n},bytesToString:function(e){if("string"==typeof e)return e;for(var r="",t=0;t<e.length;t++){var n=e[t].toString(2),i=n.match(/^1+?(?=0)/);if(i&&8==n.length){for(var o=i[0].length,a=e[t].toString(2).slice(7-o),s=1;s<o;s++)a+=e[s+t].toString(2).slice(2);r+=String.fromCharCode(parseInt(a,2)),t+=o-1}else r+=String.fromCharCode(e[t])}return r}},Gr={__proto__:null,decodeTransactionScriptABI:function(e){var r=new R(e),t=$e.deserialize(r);return{args:t.args.map(function(e){return{name:e.name,type_tag:Dr(e.type_tag)}}),code:t.code,doc:t.doc,name:t.name,ty_args:t.ty_args.map(function(e){return{name:e.name}})}}},Jr=function(e){try{return Promise.resolve(Sr(e)).then(function(r){var t=qr(r),i=Fr(r),o=Kr(n.stripHexPrefix(t),n.stripHexPrefix(i));return{privateKey:e,publicKey:r,address:t,authKey:i,receiptIdentifier:o}})}catch(e){return Promise.reject(e)}};function Xr(){var e=i.utils.randomPrivateKey(),r=Buffer.from(e).toString("hex");return n.addHexPrefix(r)}function Qr(e){return t.hexlify(e.privateKey())}function $r(e){var r=e.publicKey();return t.hexlify(r.value())}function Yr(e){return qr($r(e),T.MULTI)}function Zr(e){var r=Yr(e);return Kr(n.stripHexPrefix(r))}var et={__proto__:null,showAccount:Jr,generateAccount:function(){try{var e=Xr(),r=Jr(e);return Promise.resolve(r)}catch(e){return Promise.reject(e)}},generatePrivateKey:Xr,getMultiEd25519AccountPrivateKey:Qr,getMultiEd25519AccountPublicKey:$r,getMultiEd25519AccountAddress:Yr,getMultiEd25519AccountReceiptIdentifier:Zr,showMultiEd25519Account:function(e){var r=Qr(e),t=$r(e),n=Yr(e),i=Zr(e);return{privateKey:r,publicKey:t,address:n,authKey:Fr(t,T.MULTI),receiptIdentifier:i}},decodeMultiEd25519AccountPrivateKey:function(e){for(var r,n=t.arrayify(e),i=n.slice(0,1)[0],o=n.slice(1,2)[0],a=n.slice(2,3)[0],s=[],u=[],c=3,l=0;l<i;l+=1){var f=n.slice(c,r=c+32);s.push(t.hexlify(f)),c=r}for(var h=0;h<a;h+=1){var d=n.slice(c,r=c+32);u.push(t.hexlify(d)),c=r}return{privateKeys:u,publicKeys:s,threshold:o}}},rt={__proto__:null,InvalidNumberOfMoveArgs:function(e,r){return new Error("Invalid number of arguments to Move function. given: "+e+", expected: "+r)},InvalidNumberOfRPCParams:function(e,r,t){return new Error('Invalid number of input parameters to RPC method "'+e+'" given: '+r+", expected: "+t)},InvalidConnection:function(e){return new Error("CONNECTION ERROR: Couldn't connect to node "+e+".")},InvalidProvider:function(){return new Error("Provider not set or invalid")},InvalidResponse:function(e){var r=e&&e.error&&e.error.message?e.error.message:"Invalid JSON RPC response: "+JSON.stringify(e);return new Error(r)},ConnectionTimeout:function(e){return new Error("CONNECTION TIMEOUT: timeout of "+e+" ms achived")}},tt=function(){function e(e){this.cur_idx=0,this.toks=e}var r=e.prototype;return r.next_tok=function(){var e=this.toks[this.cur_idx++];if(void 0===e)throw new Error("out of token, this should not happen");return e},r.peek=function(){return this.toks[this.cur_idx]},r.consume_tok=function(e){var r=this.next_tok();if(r!=e)throw new Error("expected tok: "+e+", got: "+r)},r.parse_comma_list=function(e,r,t){var n=[];if(this.peek()!==r)for(;n.push(e(this)),this.peek()!==r&&(this.consume_tok("Comma"),this.peek()!==r||!t););return n},r.parseTypeTag=function(){var e=this.next_tok();if("U8Type"===e)return"U8";if("U64Type"===e)return"U64";if("U128Type"===e)return"U128";if("BoolType"===e)return"Bool";if("AddressType"===e)return"Address";if("VectorType"===e){this.consume_tok("Lt");var r=this.parseTypeTag();return this.consume_tok("Gt"),{Vector:r}}if(void 0!==e.Address){var t=e.Address;this.consume_tok("ColonColon");var n=this.next_tok();if(void 0===n.Name)throw new Error("expected name, got: "+n);var i=n.Name;this.consume_tok("ColonColon");var o=this.next_tok();if(void 0===o.Name)throw new Error("expected name, got: "+n);var a=o.Name,s=[];return"Lt"===this.peek()&&(this.consume_tok("Lt"),s=this.parse_comma_list(function(e){return e.parseTypeTag()},"Gt",!0),this.consume_tok("Gt")),{Struct:{address:t,module:i,name:a,type_params:s}}}throw new Error("unexpected token "+e+", expected type tag")},e}();function nt(e){switch(e){case"u8":return"U8Type";case"u64":return"U64Type";case"u128":return"U128Type";case"bool":return"BoolType";case"address":return"AddressType";case"vector":return"VectorType";case"true":return"True";case"false":return"False";default:return{Name:e}}}function it(e){if(0!==e.length){var r,t=e[0];if("<"===t)return["Lt",1];if(">"===t)return["Gt",1];if(","===t)return["Comma",1];if(":"===t){if(":"===e[1])return["ColonColon",2];throw new Error("unrecognized token")}if("0"===t&&["x","X"].includes(e[1])){if(a(e[2])){for(var n="0x",i=2;i<e.length&&a(e[i]);i++)n=n.concat(e[i]);return[{Address:n},n.length]}throw new Error("unrecognized token")}if(s(t))return function(e){for(var r="",t=0;t<e.length;){var n=e[t++];if(s(n))r=r.concat(n);else{if(!c(n))break;for(var i=n;t<e.length;){var o=e[t++];if(!u(o))break;i=i.concat(o)}var a=r.length+i.length;switch(i){case"u8":return[{U8:r},a];case"u64":return[{U64:r},a];case"u128":return[{U128:r},a];default:throw new Error("invalid suffix")}}}return[{U64:r},r.length]}(e);if("b"===t&&'"'===e[1]){for(var o="",f=2;;){if(f>=e.length)throw new Error("unrecognized token");var h=e[f++];if('"'===h)break;if(!(("string"==typeof(r=h)?r.charCodeAt(0):r)<=127))throw new Error("unrecognized token");o=o.concat(h)}return[{Bytes:o},o.length+3]}if("x"===t&&'"'===e[1]){for(var d="",p=2;;){if(p>=e.length)throw new Error("unrecognized token");var v=e[p++];if('"'===v)break;if(!a(v))throw new Error("unrecognized token");d=d.concat(v)}return[{Bytes:d},d.length+3]}if(c(t)||["-","_"].includes(t)){for(var m="",g=0;g<e.length&&(u(e[g])||["-","_"].includes(e[g]));g++)m=m.concat(e[g]);return[nt(m),m.length]}if(l(t)){for(var y="",_=0;_<e.length&&l(e[_]);_++)y=y.concat(e[_]);return[{WhiteSpace:y},y.length]}throw new Error("unrecognized token")}}function ot(e,r){var t=function(e){for(var r=[];;){var t=it(e);if(void 0===t)break;var n=t[1];r.push(t[0]),e=e.substring(n)}return r}(e).filter(function(e){return void 0===e.WhiteSpace});t.push("EOF");var n=new tt(t),i=r(n);return n.consume_tok("EOF"),i}function at(e){return ot(e,function(e){return e.parseTypeTag()})}var st={__proto__:null,parseTypeTags:function(e){return ot(e,function(e){return e.parse_comma_list(function(e){return e.parseTypeTag()},"EOF",!0)})},parseTypeTag:at},ut=require("../package.json").version,ct=new f.Logger(ut);function lt(e,r){e&&"object"==typeof e||ct.throwArgumentError("invalid object","object",e),Object.keys(e).forEach(function(t){r[t]||ct.throwArgumentError("invalid object key - "+t,"transaction:"+t,e)})}var ft={__proto__:null,checkProperties:lt},ht=function(e,r,i,o){try{var a=t.arrayify(n.addHexPrefix(i)),s=jr(qr(i)),u=pt(t.arrayify(n.addHexPrefix(o)),a),c=new Z(r),l=Or(new yr(s,e,u,c)),f=t.hexlify(l);return Promise.resolve(f)}catch(e){return Promise.reject(e)}},dt=function(e,r){try{var o=new Uint8Array(Buffer.from(e,"utf8")),a=vt(new gr(o));return Promise.resolve(i.getPublicKey(n.stripHexPrefix(r))).then(function(e){return Promise.resolve(i.sign(a,n.stripHexPrefix(r))).then(function(r){var n=t.hexlify(r);return Promise.resolve({publicKey:e,signature:n})})})}catch(e){return Promise.reject(e)}};function pt(e,r){var t=new le(r),n=new fe(e);return new Ke(t,n)}function vt(e){var r,t,n,i;return t=Tr().get_salt(),r=new C,e.serialize(r),n=r.getBytes(),(i=new Uint8Array(t.length+n.length)).set(t,0),i.set(n,t.length),i}function mt(e){var r,n=t.arrayify(e);return r=new R(n),yr.deserialize(r)}var gt={__proto__:null,recoverSignedMessageAddress:function(e){try{var r,n=function(e){return Promise.resolve(r)},o=mt(e),a=function(){if(o.authenticator instanceof Ke){var e=o.authenticator.signature.value,n=vt(o.message),a=o.authenticator.public_key.value;return r=qr(t.hexlify(a)),Promise.resolve(i.verify(e,n,a)).then(function(e){if(!e)throw new Error("Failed verify signature and message");if(!function(e,r){return qr(t.hexlify(e))===Cr(r)}(a,o.account))throw new Error("Failed: address are not match")})}}();return Promise.resolve(a&&a.then?a.then(n):n())}catch(e){return Promise.reject(e)}},encodeSignedMessage:function(e,r,n){try{var i=new Uint8Array(Buffer.from(e,"utf8")),o=new gr(i);return Promise.resolve(dt(e,t.hexlify(r))).then(function(e){return Promise.resolve(ht(o,n,e.publicKey,e.signature)).then(Promise.resolve)})}catch(e){return Promise.reject(e)}},generateSignedMessage:ht,signMessage:dt,encodeTransactionAuthenticatorEd25519:pt,getEd25519SignMsgBytes:vt,decodeSignedMessage:mt},yt=new f.Logger(ut),_t={test:{chainId:255,name:"test",_defaultProvider:function e(r){var t=function(e,t){return e.JsonRpcProvider?new e.JsonRpcProvider(t.jsonrpc,r):null};return t.renetwork=function(r){return e(r)},t}("test")},dev:{chainId:254,name:"dev"},barnard:{chainId:251,name:"barnard"},halley:{chainId:3,name:"halley"},proxima:{chainId:2,name:"proxima"},main:{chainId:1,name:"main"}};function wt(e){if(null==e)return null;if("number"==typeof e){for(var r in _t){var t=_t[r];if(t.chainId==e)return{name:t.name,chainId:t.chainId,_defaultProvider:t._defaultProvider||null}}return{chainId:e,name:"unknown"}}if("string"==typeof e){var n=_t[e];return null==n?null:{name:n.name,chainId:n.chainId,_defaultProvider:n._defaultProvider||null}}var i=_t[e.name];if(!i)return"number"!=typeof e.chainId&&yt.throwArgumentError("invalid network chainId","network",e),e;e.chainId!==i.chainId&&yt.throwArgumentError("network chainId mismatch","network",e);var o,a=e._defaultProvider||null;return null==a&&i._defaultProvider&&(a=(o=i._defaultProvider)&&"function"==typeof o.renetwork?i._defaultProvider.renetwork(e):i._defaultProvider),{name:e.name,chainId:i.chainId,_defaultProvider:a}}var zt=new f.Logger("abstract-provider/5.0.5"),bt=function(){function e(){zt.checkAbstract(this instanceof e?this.constructor:void 0,e),p.defineReadOnly(this,"_isProvider",!0)}var r=e.prototype;return r.getBalance=function(e,r,t){try{return void 0===r&&(r="0x1::STC::STC"),Promise.resolve(this.getResource(e,"0x1::Account::Balance<"+r+">",t)).then(function(e){if(void 0!==e)return e.token.value})}catch(e){return Promise.reject(e)}},r.getBalances=function(e,r){try{return Promise.resolve(this.getResources(e,r)).then(function(e){if(void 0!==e){var r={};for(var t in e){var n=at(t);if("object"==typeof n&&void 0!==n.Struct){var i=n.Struct;"Account"===i.module&&"Balance"===i.name&&(r[x(i.type_params[0].Struct)]=e[t].token.value)}}return r}})}catch(e){return Promise.reject(e)}},r.getSequenceNumber=function(e,r){try{return Promise.resolve(this.getResource(e,"0x1::Account::Account",r)).then(function(e){if(void 0!==e)return e.sequence_number})}catch(e){return Promise.reject(e)}},r.addListener=function(e,r){return this.on(e,r)},r.removeListener=function(e,r){return this.off(e,r)},e.isProvider=function(e){return!(!e||!e._isProvider)},e}(),kt=new f.Logger(ut);function Pt(e){return e.value.reduce(function(e,r){var t;return b({},e,((t={})[r[0]]=Et(r[1]),t))},{})}function Et(e){if("Bool"in e)return e.Bool;if("U8"in e)return e.U8;if("U64"in e)return Tt.bigint(e.U64);if("U128"in e)return Tt.bigint(e.U128);if("Address"in e)return e.Address;if("Bytes"in e)return t.hexValue(e.Bytes);if("Vector"in e)return e.Vector.map(function(e){return Et(e)});if("Struct"in e)return e.Struct.value.reduce(function(e,r){var t;return b({},e,((t={})[r[0]]=Et(r[1]),t))},{});throw new Error("invalid annotated move value, "+JSON.stringify(e))}var Tt=function(){function e(){kt.checkNew(this instanceof e?this.constructor:void 0,e),this.formats=this.getDefaultFormats()}var r=e.prototype;return r.getDefaultFormats=function(){var r={},t=this.address.bind(this),n=(this.bigNumber.bind(this),this.blockTag.bind(this)),i=this.data.bind(this),o=this.hash.bind(this),a=this.hex.bind(this),s=this.number.bind(this),u=this.u64.bind(this),c=(e.bigint.bind(this),this.u8.bind(this)),l=this.u256.bind(this);r.rawTransaction={sender:t,sequence_number:u,payload:i,max_gas_amount:u,gas_unit_price:u,gas_token_code:function(e){return e},expiration_timestamp_secs:u,chain_id:c},r.signedUserTransaction={transaction_hash:o,raw_txn:this.rawUserTransaction.bind(this),authenticator:this.transactionAuthenticator.bind(this)},r.blockMetadata={parent_hash:o,timestamp:u,author:t,author_auth_key:a,uncles:u,number:u,chain_id:c,parent_gas_used:u};var f={block_hash:e.allowNull(o),block_number:e.allowNull(u),transaction_hash:e.allowNull(o),transaction_index:e.allowNull(s)};return r.transaction=b({block_metadata:e.allowNull(this.blockMetadata.bind(this),null),user_transaction:e.allowNull(this.signedUserTransaction.bind(this),null)},f),r.blockBody={Full:e.allowNull(e.arrayOf(this.signedUserTransaction.bind(this))),Hashes:e.allowNull(e.arrayOf(o))},r.blockHeader={block_hash:o,parent_hash:o,timestamp:u,number:u,author:t,author_auth_key:e.allowNull(a,null),txn_accumulator_root:o,block_accumulator_root:o,state_root:o,gas_used:u,difficulty:l,nonce:u,body_hash:o,chain_id:c},r.blockWithTransactions={header:function(t){return e.check(r.blockHeader,t)},body:function(e){return e}},r.block={header:function(t){return e.check(r.blockHeader,t)},body:function(t){return e.check(r.blockBody,t)},confirmations:s},r.transactionInfo=b({state_root_hash:o,event_root_hash:o,gas_used:u,status:this.transactionVmStatus.bind(this),txn_events:e.allowNull(e.arrayOf(this.transactionEvent.bind(this)),null)},f),r.transactionEvent=b({data:a,type_tags:this.typeTag.bind(this),event_key:a,event_seq_number:u},f),r.transactionOutput={gas_used:u,status:this.transactionVmStatus.bind(this),events:e.allowNull(e.arrayOf(this.transactionEvent.bind(this))),write_set:e.allowNull(e.arrayOf(this.transactionWriteAction.bind(this)))},r.blockWithTransactions=p.shallowCopy(r.block),r.blockWithTransactions.transactions=e.allowNull(e.arrayOf(this.transactionResponse.bind(this))),r.eventFilter={from_block:e.allowNull(n),to_block:e.allowNull(n),event_keys:e.arrayOf(a),limit:e.allowNull(s)},r},r.typeTag=function(e){return e},r.moveValue=function(e){return Et(e)},r.moveStruct=function(e){return Pt(e)},r.transactionAuthenticator=function(e){return e},r.rawUserTransaction=function(r){return e.check(this.formats.rawTransaction,r)},r.signedUserTransaction=function(r){return e.check(this.formats.signedUserTransaction,r)},r.blockMetadata=function(r){return e.check(this.formats.blockMetadata,r)},r.transactionOutput=function(r){return e.check(this.formats.transactionOutput,r)},r.transactionWriteAction=function(e){return e},r.transactionEvent=function(r){return e.check(this.formats.transactionEvent,r)},r.transactionVmStatus=function(e){if("string"==typeof e){if([B,U,N].includes(e))return e;throw new Error("invalid txn vm_status: "+e)}if("object"==typeof e){if(e.MoveAbort)return{MoveAbort:{location:e.MoveAbort.location,abort_code:this.u64(e.MoveAbort.abort_code)}};if(e.ExecutionFailure)return e;if(e.Discard)return{Discard:{status_code:this.u64(e.Discard.status_code)}};throw new Error("invalid txn vm_status: "+JSON.stringify(e))}throw new TypeError("invalid txn vm_status type "+e)},r.number=function(e){return"0x"===e?0:d.BigNumber.from(e).toNumber()},r.u8=function(e){if("string"==typeof e)return Number.parseInt(e,10);if("number"==typeof e)return e;throw new Error("invalid u8: "+e)},r.u64=function(r){return e.bigint(r)},r.u128=function(r){return e.bigint(r)},r.u256=function(e){if("string"==typeof e)return e;if("number"==typeof e)return e.toString();throw new Error("invalid bigint: "+e)},e.bigint=function(e){if("string"==typeof e){var r=BigInt(e);return r>Number.MAX_SAFE_INTEGER?r:Number.parseInt(e)}if("number"==typeof e)return e;throw new TypeError("invalid bigint: "+e)},r.bigNumber=function(e){return d.BigNumber.from(e)},r.boolean=function(e){if("boolean"==typeof e)return e;if("string"==typeof e){if("true"===(e=e.toLowerCase()))return!0;if("false"===e)return!1}throw new Error("invalid boolean - "+e)},r.hex=function(e,r){return"string"==typeof e&&(r||"0x"===e.slice(0,2)||(e="0x"+e),t.isHexString(e))?e.toLowerCase():kt.throwArgumentError("invalid hex","value",e)},r.data=function(e,r){var t=this.hex(e,r);if(t.length%2!=0)throw new Error("invalid data; odd-length - "+e);return t},r.address=function(e){"string"!=typeof e&&kt.throwArgumentError("invalid address","address",e);var r=this.hex(e,!0);return 16!==t.hexDataLength(r)?kt.throwArgumentError("invalid address","value",e):n.addHexPrefix(e)},r.blockTag=function(e){if("earliest"===e)return 0;if("number"==typeof e)return e;throw new Error("invalid blockTag")},r.hash=function(e,r){var n=this.hex(e,r);return 32!==t.hexDataLength(n)?kt.throwArgumentError("invalid hash","value",e):n},r._block=function(r){var t=e.check(this.formats.block,r);return{header:t.header,transactions:t.body.Full?t.body.Full:t.body.Hashes,confirmations:t.confirmations}},r.blockWithTxnHashes=function(e){var r=this._block(e),t=r.confirmations;return{header:r.header,transactions:r.transactions.map(function(e){return e.transaction_hash}),confirmations:t}},r.blockWithTransactions=function(e){var r=this._block(e);return{header:r.header,transactions:r.transactions,confirmations:r.confirmations}},r.transactionResponse=function(e){return e},r.userTransactionData=function(e){return Vr(e)},r.transactionInfo=function(r){return e.check(this.formats.transactionInfo,r)},r.topics=function(e){var r=this;return Array.isArray(e)?e.map(function(e){return r.topics(e)}):null!=e?this.hash(e,!0):null},r.filter=function(r){return e.check(this.formats.eventFilter,r)},e.check=function(e,r){var t={};for(var n in e)try{var i=e[n](r[n]);void 0!==i&&(t[n]=i)}catch(e){throw e.checkKey=n,e.checkValue=r[n],e}return t},e.allowNull=function(e,r){return function(t){return null==t?r:e(t)}},e.allowFalsish=function(e,r){return function(t){return t?e(t):r}},e.arrayOf=function(e){return function(r){if(!Array.isArray(r))throw new TypeError("not an array");var t=[];return r.forEach(function(r){t.push(e(r))}),t}},e}();function xt(e,r){try{var t=e()}catch(e){return r(e)}return t&&t.then?t.then(void 0,r):t}var It=new f.Logger(ut);function Bt(e){return void 0===e||0===e.length?"*":e.join("|")}function Ut(e){if("string"==typeof e){if(e=e.toLowerCase(),32===t.hexDataLength(e))return"tx:"+e;if(-1===e.indexOf(":"))return e}else{if(Array.isArray(e))return"filter:"+Bt(e);if("object"==typeof e)return"filter:"+Bt(e.event_keys)}throw new Error("invalid event - "+e)}function Nt(){return(new Date).getTime()}var St,At={pending:"pending",block:"block",network:"network",poll:"poll",filter:"filter",tx:"tx"},Ot=[At.pending,At.block,At.network,At.poll],Vt=function(){function e(e,r,t){p.defineReadOnly(this,"tag",e),p.defineReadOnly(this,"listener",r),p.defineReadOnly(this,"once",t)}return e.prototype.pollable=function(){return this.tag.indexOf(":")>=0||Ot.indexOf(this.tag)>=0},z(e,[{key:"event",get:function(){switch(this.type){case"tx":return this.hash;case"filter":return this.filter}return this.tag}},{key:"type",get:function(){return this.tag.split(":")[0]}},{key:"hash",get:function(){var e=this.tag.split(":");return"tx"!==e[0]?null:e[1]}},{key:"filter",get:function(){var e=this.tag.split(":");if("filter"!==e[0])return null;var r,t=""===(r=e[1])||"*"===r?[]:r.split("|"),n={};return t.length>0&&(n.event_keys=t),n}}]),e}(),Rt={getChainInfo:"getChainInfo",getNodeInfo:"getNodeInfo",sendTransaction:"sendTransaction",getBlock:"getBlock",getTransactionByHash:"getTransactionByHash",getTransactionInfo:"getTransactionInfo",getEventsOfTransaction:"getEventsOfTransaction",getEvents:"getEvents",call:"call",callV2:"callV2",getCode:"getCode",getResource:"getResource",getAccountState:"getAccountState",getGasPrice:"getGasPrice",dryRun:"dryRun",dryRunRaw:"dryRunRaw"},jt=1,Ct=function(e){function r(t){var n;if(It.checkNew(this instanceof r?this.constructor:void 0,bt),(n=e.call(this)||this)._events=[],n._emitted={block:-2},n.formatter=(this instanceof r?this.constructor:void 0).getFormatter(),p.defineReadOnly(P(n),"anyNetwork","any"===t),n.anyNetwork&&(t=n.detectNetwork()),t instanceof Promise)n._networkPromise=t,t.catch(function(e){}),n._ready().catch(function(e){});else{var i=wt(t);i?(p.defineReadOnly(P(n),"_network",i),n.emit("network",i,null)):It.throwArgumentError("invalid network","network",t)}return n._maxInternalBlockNumber=-1024,n._lastBlockNumber=-2,n._pollingInterval=4e3,n._fastQueryDate=0,n}k(r,e);var n=r.prototype;return n._ready=function(){try{var e=this,r=function(){return e._network},t=function(){if(null==e._network){var r=function(){function r(){t||It.throwError("no network detected",f.Logger.errors.UNKNOWN_ERROR,{}),null==e._network&&(e.anyNetwork?e._network=t:p.defineReadOnly(e,"_network",t),e.emit("network",t,null))}var n=function(){if(null==t)return Promise.resolve(e.detectNetwork()).then(function(e){t=e})}();return n&&n.then?n.then(r):r()},t=null,n=function(){if(e._networkPromise){var r=xt(function(){return Promise.resolve(e._networkPromise).then(function(e){t=e})},function(){});if(r&&r.then)return r.then(function(){})}}();return n&&n.then?n.then(r):r()}}();return Promise.resolve(t&&t.then?t.then(r):r())}catch(e){return Promise.reject(e)}},r.getFormatter=function(){return null==St&&(St=new Tt),St},n._getInternalBlockNumber=function(e){try{var r=this;return Promise.resolve(r._ready()).then(function(){var t;function n(e){if(t)return e;var n=Nt(),i=p.resolveProperties({blockNumber:r.perform(Rt.getChainInfo,{}).then(function(e){return e.head.number},function(e){return e}),networkError:r.getNetwork().then(function(e){return null},function(e){return e})}).then(function(e){var t=e.blockNumber,o=e.networkError;if(o)throw r._internalBlockNumber===i&&(r._internalBlockNumber=null),o;var a=Nt();return(t=d.BigNumber.from(t).toNumber())<r._maxInternalBlockNumber&&(t=r._maxInternalBlockNumber),r._maxInternalBlockNumber=t,r._setFastBlockNumber(t),{blockNumber:t,reqTime:n,respTime:a}});return r._internalBlockNumber=i,Promise.resolve(i).then(function(e){return e.blockNumber})}var i=r._internalBlockNumber,o=function(){if(e>0&&r._internalBlockNumber)return Promise.resolve(i).then(function(r){if(Nt()-r.respTime<=e)return t=1,r.blockNumber})}();return o&&o.then?o.then(n):n(o)})}catch(e){return Promise.reject(e)}},n.poll=function(){try{var e=this,r=jt++,t=[];return Promise.resolve(e._getInternalBlockNumber(100+e.pollingInterval/2)).then(function(n){if(e._setFastBlockNumber(n),e.emit("poll",r,n),n!==e._lastBlockNumber){if(-2===e._emitted.block&&(e._emitted.block=n-1),Math.abs(e._emitted.block-n)>1e3)It.warn("network block skew detected; skipping block events"),e.emit("error",It.makeError("network block skew detected",f.Logger.errors.NETWORK_ERROR,{blockNumber:n,event:"blockSkew",previousBlockNumber:e._emitted.block})),e.emit(At.block,n);else for(var i=e._emitted.block+1;i<=n;i++)e.emit(At.block,i);return e._emitted.block!==n&&(e._emitted.block=n,Object.keys(e._emitted).forEach(function(r){if(r!==At.block){var t=e._emitted[r];"pending"!==t&&n-t>12&&delete e._emitted[r]}})),-2===e._lastBlockNumber&&(e._lastBlockNumber=n-1),e._events.forEach(function(r){switch(r.type){case At.tx:var i=r.hash,o=e.getTransactionInfo(i).then(function(r){return r&&null!=r.block_number?(e._emitted["t:"+i]=r.block_number,e.emit(i,r),null):null}).catch(function(r){e.emit("error",r)});t.push(o);break;case At.filter:var a=r.filter;a.from_block=e._lastBlockNumber+1,a.to_block=n;var s=e.getTransactionEvents(a).then(function(r){0!==r.length&&r.forEach(function(r){e._emitted["b:"+r.block_hash]=r.block_number,e._emitted["t:"+r.transaction_hash]=r.block_number,e.emit(a,r)})}).catch(function(r){e.emit("error",r)});t.push(s)}}),e._lastBlockNumber=n,Promise.all(t).then(function(){e.emit("didPoll",r)}),null}e.emit("didPoll",r)})}catch(e){return Promise.reject(e)}},n.getNetwork=function(){try{var e=this;return Promise.resolve(e._ready()).then(function(r){return Promise.resolve(e.detectNetwork()).then(function(t){var n,i=function(){if(r.chainId!==t.chainId){var i=function(i){if(n)return i;var o=It.makeError("underlying network changed",f.Logger.errors.NETWORK_ERROR,{event:"changed",network:r,detectedNetwork:t});throw e.emit("error",o),o},o=function(){if(e.anyNetwork)return e._network=t,e._lastBlockNumber=-2,e._fastBlockNumber=null,e._fastBlockNumberPromise=null,e._fastQueryDate=0,e._emitted.block=-2,e._maxInternalBlockNumber=-1024,e._internalBlockNumber=null,e.emit("network",t,r),Promise.resolve(new Promise(function(e){setTimeout(e,0)})).then(function(){return n=1,e._network})}();return o&&o.then?o.then(i):i(o)}}();return i&&i.then?i.then(function(e){return n?e:r}):n?i:r})})}catch(e){return Promise.reject(e)}},n._getFastBlockNumber=function(){var e=this,r=Nt();return r-this._fastQueryDate>2*this._pollingInterval&&(this._fastQueryDate=r,this._fastBlockNumberPromise=this.getBlockNumber().then(function(r){return(null==e._fastBlockNumber||r>e._fastBlockNumber)&&(e._fastBlockNumber=r),e._fastBlockNumber})),this._fastBlockNumberPromise},n._setFastBlockNumber=function(e){null!=this._fastBlockNumber&&e<this._fastBlockNumber||(this._fastQueryDate=Nt(),(null==this._fastBlockNumber||e>this._fastBlockNumber)&&(this._fastBlockNumber=e,this._fastBlockNumberPromise=Promise.resolve(e)))},n.waitForTransaction=function(e,r,t){try{var n=this;return null==r&&(r=1),Promise.resolve(n.getTransactionInfo(e)).then(function(i){return(i?i.confirmations:0)>=r?Promise.resolve(i):new Promise(function(i,o){var a=null,s=!1,u=function t(o){o.confirmations<r||(a&&clearTimeout(a),s||(s=!0,n.removeListener(e,t),i(o)))};n.on(e,u),"number"==typeof t&&t>0&&(a=setTimeout(function(){s||(a=null,s=!0,n.removeListener(e,u),o(It.makeError("timeout exceeded",f.Logger.errors.TIMEOUT,{timeout:t})))},t)).unref&&a.unref()})})}catch(e){return Promise.reject(e)}},n.getBlockNumber=function(){try{return Promise.resolve(this._getInternalBlockNumber(0))}catch(e){return Promise.reject(e)}},n.getGasPrice=function(){try{var e=this;return Promise.resolve(e.getNetwork()).then(function(){return Promise.resolve(e.perform(Rt.getGasPrice,{})).then(function(r){return e.formatter.u64(r)})})}catch(e){return Promise.reject(e)}},n.getCode=function(e,n){try{var i=this;return Promise.resolve(i.getNetwork()).then(function(){var o=r.getModuleId;return Promise.resolve(e).then(function(e){return Promise.resolve(p.resolveProperties({moduleId:o.call(r,e),blockTag:n})).then(function(e){return Promise.resolve(i.perform(Rt.getCode,e)).then(function(e){if(e)return t.hexlify(e)})})})})}catch(e){return Promise.reject(e)}},n.getResource=function(e,r,t){try{var n=this;return Promise.resolve(n.getNetwork()).then(function(){return Promise.resolve(p.resolveProperties({address:e,structTag:r,blockTag:t})).then(function(e){return Promise.resolve(n.perform(Rt.getResource,e)).then(function(e){if(e)return n.formatter.moveStruct(e)})})})}catch(e){return Promise.reject(e)}},n.getResources=function(e,r){try{var t=this;return Promise.resolve(t.getNetwork()).then(function(){return Promise.resolve(p.resolveProperties({address:e,blockTag:r})).then(function(e){return Promise.resolve(t.perform(Rt.getAccountState,e)).then(function(e){if(e)return Object.entries(e.resources).reduce(function(e,r){var n;return b({},e,((n={})[r[0]]=t.formatter.moveStruct(r[1]),n))},{})})})})}catch(e){return Promise.reject(e)}},n._wrapTransaction=function(e,r){var n=this;if(null!=r&&32!==t.hexDataLength(r))throw new Error("invalid response - sendTransaction");var i=e;return null!=r&&e.transaction_hash!==r&&It.throwError("Transaction hash mismatch from Provider.sendTransaction.",f.Logger.errors.UNKNOWN_ERROR,{expectedHash:e.transaction_hash,returnedHash:r}),i.wait=function(r){try{return 0!==r&&(n._emitted["t:"+e.transaction_hash]="pending"),Promise.resolve(n.waitForTransaction(e.transaction_hash,r)).then(function(t){return null==t&&0===r?null:(n._emitted["t:"+e.transaction_hash]=t.block_number,i.block_hash=t.block_hash,i.block_number=t.block_number,i.confirmations=r,"Executed"!==t.status&&It.throwError("transaction failed",f.Logger.errors.CALL_EXCEPTION,{transactionHash:e.transaction_hash,transaction:e,receipt:t}),t)})}catch(e){return Promise.reject(e)}},i},n.sendTransaction=function(e){try{var r=this;return Promise.resolve(r.getNetwork()).then(function(){return Promise.resolve(e).then(function(e){var t=r.formatter.userTransactionData(e);return xt(function(){return Promise.resolve(r.perform(Rt.sendTransaction,{signedTransaction:e})).then(function(){return r._wrapTransaction(t)})},function(e){throw e.transaction=t,e.transactionHash=t.transaction_hash,e})})})}catch(e){return Promise.reject(e)}},r.getModuleId=function(e){return"string"==typeof e?e:e.address+"::"+e.name},n._getFilter=function(e){try{var r=this;return Promise.resolve(e).then(function(e){var t=r.formatter,n=t.filter;return Promise.resolve(p.resolveProperties(e)).then(function(e){return n.call(t,e)})})}catch(e){return Promise.reject(e)}},n.call=function(e,r){try{var t=this;return Promise.resolve(t.getNetwork()).then(function(){return Promise.resolve(p.resolveProperties({request:e})).then(function(e){return e.request.function_id=S(e.request.function_id),Promise.resolve(t.perform(Rt.call,e)).then(function(e){return e.map(function(e){return t.formatter.moveValue(e)})})})})}catch(e){return Promise.reject(e)}},n.callV2=function(e,r){try{var t=this;return Promise.resolve(t.getNetwork()).then(function(){return Promise.resolve(p.resolveProperties({request:e})).then(function(e){return e.request.function_id=S(e.request.function_id),Promise.resolve(t.perform(Rt.callV2,e)).then(function(e){return e.map(function(e){return e})})})})}catch(e){return Promise.reject(e)}},n.dryRun=function(e){try{var r=this;return Promise.resolve(r.getNetwork()).then(function(){return Promise.resolve(p.resolveProperties({transaction:e})).then(function(e){return Promise.resolve(r.perform(Rt.dryRun,e)).then(function(e){return r.formatter.transactionOutput(e)})})})}catch(e){return Promise.reject(e)}},n.dryRunRaw=function(e,r){try{var t=this;return Promise.resolve(t.getNetwork()).then(function(){return Promise.resolve(t.perform(Rt.dryRunRaw,{rawUserTransactionHex:e,publicKeyHex:r})).then(function(e){return t.formatter.transactionOutput(e)})})}catch(e){return Promise.reject(e)}},n._getBlock=function(e,r){try{var n=this;return Promise.resolve(n.getNetwork()).then(function(){return Promise.resolve(e).then(function(i){function o(){return v.poll(function(){try{return Promise.resolve(n.perform(Rt.getBlock,s)).then(function(e){var t;function i(r){return t?r:n.formatter.blockWithTxnHashes(e)}if(null==e)return null!=s.blockHash&&null==n._emitted["b:"+s.blockHash]||null!=s.blockNumber&&a>n._emitted.block?null:void 0;var o=function(){if(r)return Promise.resolve(n._getInternalBlockNumber(100+2*n.pollingInterval)).then(function(r){var i=r-e.header.number+1;return i<=0&&(i=1),e.confirmations=i,t=1,n.formatter.blockWithTransactions(e)})}();return o&&o.then?o.then(i):i(o)})}catch(e){return Promise.reject(e)}},{oncePoll:n})}e=i;var a=-128,s={includeTransactions:!!r},u=function(){if(t.isHexString(e,32))s.blockHash=e;else{var r=xt(function(){return Promise.resolve(n._getBlockTag(e)).then(function(e){s.blockNumber=e,a=s.blockNumber})},function(){It.throwArgumentError("invalid block hash or block number","blockHashOrBlockNumber",e)});if(r&&r.then)return r.then(function(){})}}();return u&&u.then?u.then(o):o()})})}catch(e){return Promise.reject(e)}},n.getBlock=function(e){return this._getBlock(e,!0)},n.getTransaction=function(e){try{var r=this;return Promise.resolve(r.getNetwork()).then(function(){return Promise.resolve(e).then(function(t){var n={transactionHash:r.formatter.hash(e=t,!0)};return v.poll(function(){try{return Promise.resolve(r.perform(Rt.getTransactionByHash,n)).then(function(t){function n(){return r._wrapTransaction(i)}if(null==t)return null==r._emitted["t:"+e]?null:void 0;var i=r.formatter.transactionResponse(t),o=function(){if(void 0===i.block_number)i.confirmations=0;else{var e=function(){if(void 0===i.confirmations)return Promise.resolve(r._getInternalBlockNumber(100+2*r.pollingInterval)).then(function(e){var r=e-i.block_number+1;r<=0&&(r=1),i.confirmations=r})}();if(e&&e.then)return e.then(function(){})}}();return o&&o.then?o.then(n):n()})}catch(e){return Promise.reject(e)}},{oncePoll:r})})})}catch(e){return Promise.reject(e)}},n.getTransactionInfo=function(e){try{var r=this;return Promise.resolve(r.getNetwork()).then(function(){return Promise.resolve(e).then(function(t){var n={transactionHash:r.formatter.hash(e=t,!0)};return v.poll(function(){try{return Promise.resolve(r.perform(Rt.getTransactionInfo,n)).then(function(t){if(null===t)return null===r._emitted["t:"+e]?null:void 0;if(null!==t.block_hash){var n=r.formatter.transactionInfo(t),i=function(){if(null===n.block_number)n.confirmations=0;else{var e=function(){if(!n.confirmations)return Promise.resolve(r._getInternalBlockNumber(100+2*r.pollingInterval)).then(function(e){var r=e-n.block_number+1;r<=0&&(r=1),n.confirmations=r})}();if(e&&e.then)return e.then(function(){})}}();return i&&i.then?i.then(function(){return n}):n}})}catch(e){return Promise.reject(e)}},{oncePoll:r})})})}catch(e){return Promise.reject(e)}},n.getEventsOfTransaction=function(e){try{var r=this;return Promise.resolve(r.getNetwork()).then(function(){return Promise.resolve(e).then(function(t){var n={transactionHash:r.formatter.hash(e=t,!0)};return Promise.resolve(r.perform(Rt.getEventsOfTransaction,n)).then(function(e){return Tt.arrayOf(r.formatter.transactionEvent.bind(r.formatter))(e)})})})}catch(e){return Promise.reject(e)}},n.getTransactionEvents=function(e){try{var r=this;return Promise.resolve(r.getNetwork()).then(function(){return Promise.resolve(p.resolveProperties({filter:e})).then(function(e){return Promise.resolve(r.perform(Rt.getEvents,e)).then(function(e){return Tt.arrayOf(r.formatter.transactionEvent.bind(r.formatter))(e)})})})}catch(e){return Promise.reject(e)}},n._getBlockTag=function(e){try{var r=this;return Promise.resolve(e).then(function(t){return(e=t)<0?(e%1&&It.throwArgumentError("invalid BlockTag","blockTag",e),Promise.resolve(r._getInternalBlockNumber(100+2*r.pollingInterval)).then(function(r){return(r+=e)<0&&(r=0),r})):e})}catch(e){return Promise.reject(e)}},n._startEvent=function(e){this.polling=this._events.filter(function(e){return e.pollable()}).length>0},n._stopEvent=function(e){this.polling=this._events.filter(function(e){return e.pollable()}).length>0},n._addEventListener=function(e,r,t){var n=new Vt(Ut(e),r,t);return this._events.push(n),this._startEvent(n),this},n.on=function(e,r){return this._addEventListener(e,r,!1)},n.once=function(e,r){return this._addEventListener(e,r,!0)},n.emit=function(e){var r=arguments,t=this,n=!1,i=[],o=Ut(e);return this._events=this._events.filter(function(e){return e.tag!==o||(setTimeout(function(){e.listener.apply(t,[].slice.call(r,1))},0),n=!0,!e.once||(i.push(e),!1))}),i.forEach(function(e){t._stopEvent(e)}),n},n.listenerCount=function(e){if(!e)return this._events.length;var r=Ut(e);return this._events.filter(function(e){return e.tag===r}).length},n.listeners=function(e){if(null==e)return this._events.map(function(e){return e.listener});var r=Ut(e);return this._events.filter(function(e){return e.tag===r}).map(function(e){return e.listener})},n.off=function(e,r){var t=this;if(null===r)return this.removeAllListeners(e);var n=[],i=!1,o=Ut(e);return this._events=this._events.filter(function(e){return e.tag!==o||e.listener!==r||!!i||(i=!0,n.push(e),!1)}),n.forEach(function(e){t._stopEvent(e)}),this},n.removeAllListeners=function(e){var r=this,t=[];if(null===e)t=this._events,this._events=[];else{var n=Ut(e);this._events=this._events.filter(function(e){return e.tag!==n||(t.push(e),!1)})}return t.forEach(function(e){r._stopEvent(e)}),this},z(r,[{key:"ready",get:function(){var e=this;return v.poll(function(){return e._ready().then(function(e){return e},function(e){if(e.code!==f.Logger.errors.NETWORK_ERROR||"noNetwork"!==e.event)throw e})})}},{key:"network",get:function(){return this._network}},{key:"blockNumber",get:function(){return this._getInternalBlockNumber(100+this.pollingInterval/2),null!=this._fastBlockNumber?this._fastBlockNumber:-1}},{key:"polling",get:function(){return null!=this._poller},set:function(e){var r=this;e&&!this._poller?(this._poller=setInterval(this.poll.bind(this),this.pollingInterval),this._bootstrapPoll||(this._bootstrapPoll=setTimeout(function(){r.poll(),r._bootstrapPoll=setTimeout(function(){r._poller||r.poll(),r._bootstrapPoll=null},r.pollingInterval)},0))):!e&&this._poller&&(clearInterval(this._poller),this._poller=null)}},{key:"pollingInterval",get:function(){return this._pollingInterval},set:function(e){var r=this;if("number"!=typeof e||e<=0||parseInt(String(e))!=e)throw new Error("invalid polling interval");this._pollingInterval=e,this._poller&&(clearInterval(this._poller),this._poller=setInterval(function(){r.poll()},this._pollingInterval))}}]),r}(bt),Lt=new f.Logger(ut),Mt=new Set(["sender","sender_public_key","sequence_number","script","modules","max_gas_amount","gas_unit_price","gas_token_code","chain_id"]),Ht=new Set([f.Logger.errors.INSUFFICIENT_FUNDS,f.Logger.errors.NONCE_EXPIRED,f.Logger.errors.REPLACEMENT_UNDERPRICED]),Dt=function(){function e(){Lt.checkAbstract(this instanceof e?this.constructor:void 0,e),p.defineReadOnly(this,"_isSigner",!0)}var r=e.prototype;return r.getBalance=function(e,r){try{return this.checkProvider("getBalance"),Promise.resolve(this.provider.getBalance(this.getAddress(),e,r))}catch(e){return Promise.reject(e)}},r.getSequenceNumber=function(e){try{return this.checkProvider("getSequenceNumber"),Promise.resolve(this.provider.getSequenceNumber(this.getAddress(),e))}catch(e){return Promise.reject(e)}},r.estimateGas=function(e){try{var r=this;return r.checkProvider("estimateGas"),Promise.resolve(p.resolveProperties(r.checkTransaction(e))).then(function(e){return Promise.resolve(r.provider.dryRun(e)).then(function(e){return"number"==typeof e.gas_used?3*e.gas_used:3n*e.gas_used.valueOf()})})}catch(e){return Promise.reject(e)}},r.sendTransaction=function(e){var r=this;return this.checkProvider("sendTransaction"),this.populateTransaction(e).then(function(e){return r.signTransaction(e).then(function(e){return r.provider.sendTransaction(e)})})},r.getChainId=function(){try{return this.checkProvider("getChainId"),Promise.resolve(this.provider.getNetwork()).then(function(e){return e.chainId})}catch(e){return Promise.reject(e)}},r.getGasPrice=function(){try{return this.checkProvider("getGasPrice"),Promise.resolve(this.provider.getGasPrice())}catch(e){return Promise.reject(e)}},r.checkTransaction=function(e){for(var r=0,t=Object.keys(e);r<t.length;r++){var n=t[r];Mt.has(n)||Lt.throwArgumentError("invalid transaction key: "+n,"transaction",e)}var i=p.shallowCopy(e);return i.sender=void 0===i.sender?this.getAddress():Promise.all([Promise.resolve(i.sender),this.getAddress()]).then(function(r){return r[0]!==r[1]&&Lt.throwArgumentError("from address mismatch","transaction",e),r[0]}),i},r.populateTransaction=function(e){try{var r=this;return Promise.resolve(p.resolveProperties(r.checkTransaction(e))).then(function(t){return void 0===t.gas_unit_price&&(t.gas_unit_price=r.getGasPrice()),void 0===t.sequence_number&&(t.sequence_number=r.getSequenceNumber("pending")),t.chain_id=void 0===t.chain_id?r.getChainId():Promise.all([Promise.resolve(t.chain_id),r.getChainId()]).then(function(r){return 0!==r[1]&&r[0]!==r[1]&&Lt.throwArgumentError("chainId address mismatch","transaction",e),r[0]}),void 0===t.max_gas_amount&&(t.max_gas_amount=r.estimateGas(t).catch(function(e){if(Ht.has(e.code))throw e;return console.log("err: "+e),Lt.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",f.Logger.errors.UNPREDICTABLE_GAS_LIMIT,{error:e,tx:t})})),p.resolveProperties(t)})}catch(e){return Promise.reject(e)}},r.checkProvider=function(e){this.provider||Lt.throwError("missing provider",f.Logger.errors.UNSUPPORTED_OPERATION,{operation:e||"_checkProvider"})},e.isSigner=function(e){return!(!e||!e._isSigner)},e}();function Ft(e,r){try{var t=e()}catch(e){return r(e)}return t&&t.then?t.then(void 0,r):t}var qt=new f.Logger(ut),Kt=new Set(["call","estimateGas"]);function Wt(e,r,t){var n=r.message;r.code===f.Logger.errors.SERVER_ERROR&&r.error&&"string"==typeof r.error.message?n=r.error.message:"string"==typeof r.body?n=r.body:"string"==typeof r.responseText&&(n=r.responseText),n=(n||"").toLowerCase();var i=t.transaction||t.signedTransaction;throw n.match(/insufficient funds/)&&qt.throwError("insufficient funds for intrinsic transaction cost",f.Logger.errors.INSUFFICIENT_FUNDS,{error:r,method:e,transaction:i}),n.match(/nonce too low/)&&qt.throwError("nonce has already been used",f.Logger.errors.NONCE_EXPIRED,{error:r,method:e,transaction:i}),n.match(/replacement transaction underpriced/)&&qt.throwError("replacement fee too low",f.Logger.errors.REPLACEMENT_UNDERPRICED,{error:r,method:e,transaction:i}),Kt.has(e)&&n.match(/gas required exceeds allowance|always failing transaction|execution reverted/)&&qt.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",f.Logger.errors.UNPREDICTABLE_GAS_LIMIT,{error:r,method:e,transaction:i}),r}function Gt(e){if(e.error){var r=new Error(e.error.message);throw r.code=e.error.code,r.data=e.error.data,r}return e.result}var Jt={},Xt=function(e){function r(t,n,i){var o;if(qt.checkNew(this instanceof r?this.constructor:void 0,r),o=e.call(this)||this,t!==Jt)throw new Error("do not call the JsonRpcSigner constructor directly; use provider.getSigner");return p.defineReadOnly(P(o),"provider",n),void 0===i&&(i=0),"string"==typeof i?p.defineReadOnly(P(o),"_address",o.provider.formatter.address(i)):"number"==typeof i?p.defineReadOnly(P(o),"_index",i):qt.throwArgumentError("invalid address or index","addressOrIndex",i),o}k(r,e);var n=r.prototype;return n.connect=function(e){return qt.throwError("cannot alter JSON-RPC Signer connection",f.Logger.errors.UNSUPPORTED_OPERATION,{operation:"connect"})},n.getAddress=function(){try{var e=this;return Promise.resolve(e._address?e._address:e.provider.send("stc_accounts",[]).then(function(r){return r.length<=e._index&&qt.throwError("unknown account #"+e._index,f.Logger.errors.UNSUPPORTED_OPERATION,{operation:"getAddress"}),e.provider.formatter.address(r[e._index])}))}catch(e){return Promise.reject(e)}},n.sendUncheckedTransaction=function(e){var r=this;qt.debug("sendUncheckedTransaction",e),e=p.shallowCopy(e);var t=this.getAddress().then(function(e){return e&&(e=e.toLowerCase()),e});return qt.debug(t),p.resolveProperties({tx:p.resolveProperties(e),sender:t}).then(function(t){var n=t.tx,i=t.sender;null!=n.from?n.from.toLowerCase()!==i&&qt.throwArgumentError("from address mismatch","transaction",e):n.from=i;var o=r.provider.constructor.hexlifyTransaction(n,{from:!0,expiredSecs:!0,addGasBufferMultiplier:!0});return n.addGasBufferMultiplier&&"number"==typeof n.addGasBufferMultiplier&&(o.addGasBufferMultiplier=n.addGasBufferMultiplier.toString()),qt.debug(o),r.provider.send("stc_sendTransaction",[o]).then(function(e){return e},function(e){throw e.responseText&&(e.responseText.indexOf("insufficient funds")>=0&&qt.throwError("insufficient funds",f.Logger.errors.INSUFFICIENT_FUNDS,{transaction:n}),e.responseText.indexOf("nonce too low")>=0&&qt.throwError("nonce has already been used",f.Logger.errors.NONCE_EXPIRED,{transaction:n}),e.responseText.indexOf("replacement transaction underpriced")>=0&&qt.throwError("replacement fee too low",f.Logger.errors.REPLACEMENT_UNDERPRICED,{transaction:n})),e})})},n.signTransaction=function(e){try{var r=this;return Promise.resolve(p.resolveProperties(e)).then(function(t){return Promise.resolve(r.getAddress()).then(function(n){return void 0!==t.sender?t.sender!==n&&qt.throwArgumentError("from address mismatch","transaction",e):t.sender=n,r.provider.send("account.sign_txn_request",[t]).then(function(e){return e},function(e){return Wt("signTransaction",e,t)})})})}catch(e){return Promise.reject(e)}},n.signMessage=function(e){try{var r=this.provider;return Promise.resolve(this.getAddress()).then(function(n){var i;if("string"==typeof e)i=new Uint8Array(Buffer.from(e));else{if(!t.isBytes(e))return qt.throwError("type of message input is unsupported",f.Logger.errors.UNSUPPORTED_OPERATION,{operation:"signMessage"});i=e}var o={message:Array.from(i)};return r.send("account.sign",[n.toLowerCase(),o])})}catch(e){return Promise.reject(e)}},n.unlock=function(e){try{var r=this.provider;return Promise.resolve(this.getAddress()).then(function(t){return r.send("account.unlock",[t.toLowerCase(),e,void 0])})}catch(e){return Promise.reject(e)}},r}(Dt),Qt={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0},$t=function(e){function r(t,n){var i;qt.checkNew(this instanceof r?this.constructor:void 0,r);var o=n;return null==o&&(o=new Promise(function(e,r){setTimeout(function(){i.detectNetwork().then(function(r){e(r)},function(e){r(e)})},0)})),i=e.call(this,o)||this,t||(t=p.getStatic(i.constructor,"defaultUrl")()),p.defineReadOnly(P(i),"connection",Object.freeze("string"==typeof t?{url:t}:p.shallowCopy(t))),i._nextId=42,i}k(r,e),r.defaultUrl=function(){return"http://localhost:9850"};var n=r.prototype;return n.detectNetwork=function(){try{var e=this;return Promise.resolve(new Promise(function(e){setTimeout(e,0)})).then(function(){function r(){if(null!=t)try{return wt(d.BigNumber.from(t).toNumber())}catch(e){return qt.throwError("could not detect network",f.Logger.errors.NETWORK_ERROR,{chainId:t,event:"invalidNetwork",serverError:e})}return qt.throwError("could not detect network",f.Logger.errors.NETWORK_ERROR,{event:"noNetwork"})}var t=null,n=Ft(function(){return Promise.resolve(e.send("chain.id",[])).then(function(e){t=e.id})},function(){var r=Ft(function(){return Promise.resolve(e.perform(Rt.getChainInfo,null)).then(function(e){t=e.chain_id})},function(){});return r&&r.then?r.then(function(){}):void 0});return n&&n.then?n.then(r):r()})}catch(e){return Promise.reject(e)}},n.getSigner=function(e){return new Xt(Jt,this,e)},n.getNowSeconds=function(){try{return Promise.resolve(this.perform(Rt.getNodeInfo,null)).then(function(e){return e.now_seconds})}catch(e){return Promise.reject(e)}},n.send=function(e,r){var t=this,n={method:e,params:r,id:this._nextId++,jsonrpc:"2.0"};return this.emit("debug",{action:"request",request:p.deepCopy(n),provider:this}),v.fetchJson(this.connection,JSON.stringify(n),Gt).then(function(e){return t.emit("debug",{action:"response",request:n,response:e,provider:t}),e},function(e){throw t.emit("debug",{action:"response",error:e,request:n,provider:t}),e})},n.prepareRequest=function(e,r){switch(e){case Rt.getChainInfo:return["chain.info",[]];case Rt.getNodeInfo:return["node.info",[]];case Rt.getGasPrice:return["txpool.gas_price",[]];case Rt.dryRun:return["contract.dry_run",[r.transaction]];case Rt.dryRunRaw:return["contract.dry_run_raw",[r.rawUserTransactionHex,r.publicKeyHex]];case Rt.sendTransaction:return["txpool.submit_hex_transaction",[r.signedTransaction]];case Rt.getBlock:if(void 0!==r.blockNumber)return["chain.get_block_by_number",[r.blockNumber]];if(void 0!==r.blockHash)return["chain.get_block_by_hash",[r.blockHash]];break;case Rt.getTransactionByHash:return["chain.get_transaction",[r.transactionHash]];case Rt.getTransactionInfo:return["chain.get_transaction_info",[r.transactionHash]];case Rt.getEventsOfTransaction:return["chain.get_events_by_txn_hash",[r.transactionHash]];case Rt.getCode:return["contract.get_code",[r.moduleId]];case Rt.getResource:return["contract.get_resource",[r.address,r.structTag]];case Rt.getAccountState:return["state.get_account_state_set",[r.address]];case Rt.call:return["contract.call",[r.request]];case Rt.callV2:return["contract.call_v2",[r.request]];case Rt.getEvents:return["chain.get_events",[r.filter]]}},n.perform=function(e,r){try{var t=this,n=t.prepareRequest(e,r);return void 0===n&&qt.throwError(e+" not implemented",f.Logger.errors.NOT_IMPLEMENTED,{operation:e}),Promise.resolve(Ft(function(){return Promise.resolve(t.send(n[0],n[1]))},function(t){return Wt(e,t,r)}))}catch(e){return Promise.reject(e)}},n._startEvent=function(r){"pending"===r.tag&&qt.throwError("pending event not implemented",f.Logger.errors.NOT_IMPLEMENTED,{operation:"pending event"}),e.prototype._startEvent.call(this,r)},n._stopEvent=function(r){r.tag===At.pending&&0===this.listenerCount(At.pending)&&(this._pendingFilter=null),e.prototype._stopEvent.call(this,r)},r.hexlifyTransaction=function(e,r){var n=p.shallowCopy(Qt);if(r)for(var i in r)r[i]&&(n[i]=!0);lt(e,n);var o={};return["gasLimit","gasPrice","nonce","value","expiredSecs"].forEach(function(r){if(null!=e[r]){var n=t.hexValue(e[r]);"gasLimit"===r&&(r="gas"),o[r]=n}}),["from","to","data"].forEach(function(r){null!=e[r]&&(o[r]=t.hexlify(e[r]))}),o},r}(Ct),Yt=function(e,r){try{return Promise.resolve(en(r,e)).then(function(t){return Promise.resolve(Zt(e,t,r))})}catch(e){return Promise.reject(e)}},Zt=function(e,r,t){try{return Promise.resolve(i.getPublicKey(n.stripHexPrefix(e))).then(function(e){var n=tn(e,r,t);return Promise.resolve(n)})}catch(e){return Promise.reject(e)}},en=function(e,r){try{var o=Er().get_salt(),a=(f=new C,e.serialize(f),f.getBytes()),s=(u=o,c=a,(l=new Uint8Array(u.length+c.length)).set(u,0),l.set(c,u.length),l);return Promise.resolve(i.sign(s,n.stripHexPrefix(r))).then(function(e){return t.hexlify(e)})}catch(e){return Promise.reject(e)}var u,c,l,f};function rn(e,r,t){var n=A(e),i=new Ue(new ye(jr(n.address),new ve(n.module)),new ve(n.functionName),r.map(function(e){return Lr(e)}),t);return new Qe(i)}function tn(e,r,i){var o=new le(t.arrayify(n.addHexPrefix(e))),a=new fe(t.arrayify(n.addHexPrefix(r))),s=new Ke(o,a);return new Se(i,s)}function nn(e){return e.map(function(e){return function e(r){var t=r.split("<"),n=t[0].split("::"),i=n[0],o=n[1],a=n[2],s=t[1]?t[1].replace(">","").split(","):[],u=[];return s.length>0&&s.forEach(function(r){u.push(e(r.trim()))}),{Struct:{address:i,module:o,name:a,type_params:u}}}(e)})}function on(e,r){return r.map(function(r,i){return function(e,r){if("Address"===r)return t.arrayify(e);var i=new C;if(r&&"U8"===r.Vector){if(!e)return Buffer.from("");for(var o=t.isHexString(n.addHexPrefix(e))?Br(e):new Uint8Array(Buffer.from(e)),a=o.length,s=[],u=0;u<a;u++)s.push(o[u]);pr.serializeVectorU8(s,i);var c=t.hexlify(i.getBytes());return t.arrayify(c)}if(r&&r.Vector&&Array.isArray(e)){i.serializeLen(e.length),e.forEach(function(e){"U8"===r.Vector.Vector?i.serializeBytes(Br(e)):r.Vector&&i["serialize"+r.Vector](e)});var l=t.hexlify(i.getBytes());return t.arrayify(l)}if(r){i["serialize"+r](e);var f=t.hexlify(i.getBytes());return t.arrayify(f)}return e}(r,e[i].type_tag)})}var an=function(e,r){try{return Promise.resolve(Promise.all(Object.keys(e.private_keys).map(function(n){var i=t.hexlify(e.private_keys[n].value);return en(r,i).then(function(e){return[new fe(t.arrayify(e)),Number.parseInt(n,10)]}).catch(function(e){throw new Error("invalid private key: "+e)})}))).then(function(e){console.log({signatures:e});var r=ze.build(e);return console.log({multiEd25519Signature:r}),Promise.resolve(r)})}catch(e){return Promise.reject(e)}},sn={__proto__:null,abi:Gr,account:et,errors:rt,helper:W,hex:Nr,parser:st,properties:ft,signedMessage:gt,multiSign:{__proto__:null,generateMultiEd25519SignatureShard:function(e,r){try{return Promise.resolve(an(e,r)).then(function(r){console.log({multiEd25519Signature:r});var t=new be(r,e.threshold);return Promise.resolve(t)})}catch(e){return Promise.reject(e)}},generateMultiEd25519Signature:an,generateMultiEd25519KeyShard:function(e,r,n){try{if(0===r.length)throw new Error("require at least one private key");var i=h.cloneDeep(e),o={};return Promise.resolve(Promise.all(r.map(function(e){return Sr(e).then(function(r){return i.push(r),o[r]=e,r}).catch(function(e){throw new Error("invalid private key: "+e)})}))).then(function(){i.sort(function(e,r){return e>r?1:-1});var e=i.filter(function(e,r,t){return t.indexOf(e)===r}),o={};return Promise.resolve(Promise.all(r.map(function(r){return Sr(r).then(function(n){var i=e.indexOf(n);return i>-1&&(o[i]=new ce(t.arrayify(r))),n}).catch(function(e){throw new Error("invalid private key: "+e)})}))).then(function(){var r=e.map(function(e){return new le(t.arrayify(e))}),i=new ke(r,n,o);return Promise.resolve(i)})})}catch(e){return Promise.reject(e)}}},tx:{__proto__:null,encodeScriptFunctionByResolve:function(e,r,t,n){try{var i=nn(r),o=new $t(n);return Promise.resolve(o.send("contract.resolve_function",[e])).then(function(r){var n=r.args;n[0]&&"Signer"===n[0].type_tag&&n.shift();var o=on(n,t);return rn(e,i,o)})}catch(e){return Promise.reject(e)}},signRawUserTransaction:function(e,r){try{return Promise.resolve(Yt(e,r)).then(function(e){return function(e){var r=new C;return e.serialize(r),t.hexlify(r.getBytes())}(e)})}catch(e){return Promise.reject(e)}},getSignedUserTransaction:Yt,getSignatureHex:en,encodeTransactionScript:function(e,r,n){var i=new Te(e,r.map(function(e){return Lr(e)}),n.map(function(e){return t.arrayify(e)}));return new Je(i)},encodeScriptFunction:rn,encodePackage:function(e,r,n){var i=r.map(function(e){return new ge(t.arrayify(e))}),o=null;n&&(o=rn(n.functionId,n.tyArgs,n.args));var a=new Pe(jr(e),i,o);return new Xe(a)},generateRawUserTransaction:function(e,r,t,n,i,o,a){var s=jr(e),u=BigInt(i),c=BigInt(t),l=BigInt(n),f=BigInt(o),h=new Z(a);return new Ee(s,u,r,c,l,"0x1::STC::STC",f,h)},signTxn:tn,encodeStructTypeTags:nn,encodeScriptFunctionArgs:on}},un={__proto__:null,BinaryDeserializer:V,BinarySerializer:j},cn=new f.Logger(ut),ln=1;function fn(e,r){return function(e,t){var n={method:e,params:t,id:ln+=1,jsonrpc:"2.0"};return new Promise(function(e,t){r(n,function(r,n){if(r)return t(r);if(n.error){var i=new Error(n.error.message);return i.code=n.error.code,i.data=n.error.data,t(i)}e(n.result)})})}}var hn=function(e){function r(t,n){var i,o,a,s;return cn.checkNew(this instanceof r?this.constructor:void 0,r),void 0===t&&cn.throwArgumentError("missing provider","provider",t),"function"==typeof t?(o="unknown:",a=t):(!(o=t.host||t.path||"")&&t.isStarMask&&(o="starmask"),s=t,t.sendAsync?a=fn(0,t.sendAsync.bind(t)):t.send?a=fn(0,t.send.bind(t)):cn.throwArgumentError("unsupported provider","provider",t),o||(o="unknown:")),i=e.call(this,o,n)||this,p.defineReadOnly(P(i),"jsonRpcFetchFunc",a),p.defineReadOnly(P(i),"provider",s),i}return k(r,e),r.prototype.send=function(e,r){return this.jsonRpcFetchFunc(e,r)},r}($t),dn=new f.Logger(ut),pn=1,vn={__proto__:null,CONSTANTS:At,Event:Vt,RPC_ACTION:Rt,BaseProvider:Ct,formatMoveStruct:Pt,formatMoveValue:Et,Formatter:Tt,JsonRpcSigner:Xt,JsonRpcProvider:$t,Web3Provider:hn,WebsocketProvider:function(e){function r(r,t){var n;"any"===t&&dn.throwError("WebSocketProvider does not support 'any' network yet",f.Logger.errors.UNSUPPORTED_OPERATION,{operation:"network:any"}),(n=e.call(this,r,t)||this)._pollingInterval=-1,n._wsReady=!1,p.defineReadOnly(P(n),"_websocket",new y(n.connection.url)),p.defineReadOnly(P(n),"_requests",{}),p.defineReadOnly(P(n),"_subs",{}),p.defineReadOnly(P(n),"_subIds",{}),p.defineReadOnly(P(n),"_detectNetwork",e.prototype.detectNetwork.call(P(n))),n._websocket.onopen=function(){n._wsReady=!0,Object.keys(n._requests).forEach(function(e){n._websocket.send(n._requests[e].payload)})},n._websocket.onmessage=function(e){var r=e.data,t=JSON.parse(r);if(null!=t.id){var i,o=String(t.id),a=n._requests[o];delete n._requests[o],void 0!==t.result?(a.callback(null,t.result),n.emit("debug",{action:"response",request:JSON.parse(a.payload),response:t.result,provider:P(n)})):(t.error?(i=new Error(t.error.message||"unknown error"),p.defineReadOnly(i,"code",t.error.code||null),p.defineReadOnly(i,"response",r)):i=new Error("unknown error"),a.callback(i,void 0),n.emit("debug",{action:"response",error:i,request:JSON.parse(a.payload),provider:P(n)}))}else if("starcoin_subscription"===t.method){var s=n._subs[t.params.subscription];s&&s.processFunc(t.params.result)}else console.warn("this should not happen")};var i=setInterval(function(){n.emit("poll")},1e3);return i.unref&&i.unref(),n}k(r,e);var t=r.prototype;return t.detectNetwork=function(){return this._detectNetwork},t.poll=function(){return Promise.resolve(null)},t.send=function(e,r){var t=this,n=pn++;return new Promise(function(i,o){var a=JSON.stringify({method:e,params:r,id:n,jsonrpc:"2.0"});t.emit("debug",{action:"request",request:JSON.parse(a),provider:t}),t._requests[String(n)]={callback:function(e,r){return e?o(e):i(r)},payload:a},t._wsReady&&t._websocket.send(a)})},r.defaultUrl=function(){return"ws://localhost:9870"},t._subscribe=function(e,r,t){try{var n=this,i=n._subIds[e];return null==i&&(i=Promise.all(r).then(function(e){return n.send("starcoin_subscribe",e)}),n._subIds[e]=i),Promise.resolve(i).then(function(r){n._subs[r]={tag:e,processFunc:t}})}catch(e){return Promise.reject(e)}},t._startEvent=function(e){var r=this;switch(e.type){case At.block:this._subscribe(At.block,[{type_name:"newHeads"}],function(e){var t=r.formatter.u64(e.header.number);r._emitted.block=t,r.emit(At.block,t)});break;case At.pending:this._subscribe(At.pending,[{type_name:"newPendingTransactions"}],function(e){r.emit(At.pending,e)});break;case At.filter:this._subscribe(e.tag,[{type_name:"events"},e.filter],function(t){r.emit(e.filter,r.formatter.transactionEvent(t))});break;case At.tx:var t=function(e){var t=e.hash;r.getTransactionInfo(t).then(function(e){e&&r.emit(t,e)})};t(e),this._subscribe(At.tx,[{type_name:"newHeads"}],function(e){r._events.filter(function(e){return e.type===At.tx}).forEach(t)});break;case"debug":case"poll":case"willPoll":case"didPoll":case"error":break;default:console.log("unhandled:",e)}},t._stopEvent=function(e){var r=this,t=e.tag;if(e.type===At.tx){if(this._events.filter(function(e){return e.type===At.tx}).length)return;t=At.tx}else if(this.listenerCount(e.event))return;var n=this._subIds[t];n&&(delete this._subIds[t],n.then(function(e){r._subs[e]&&(delete r._subs[e],r.send("starcoin_unsubscribe",[e]))}))},t.destroy=function(){try{var e=this,r=function(){e._websocket.close(1e3)},t=function(){if(e._websocket.readyState===y.CONNECTING)return Promise.resolve(new Promise(function(r){e._websocket.onopen=function(){r(!0)},e._websocket.onerror=function(){r(!1)}})).then(function(){})}();return Promise.resolve(t&&t.then?t.then(r):r())}catch(e){return Promise.reject(e)}},z(r,[{key:"pollingInterval",get:function(){return 0},set:function(e){dn.throwError("cannot set polling interval on WebSocketProvider",f.Logger.errors.UNSUPPORTED_OPERATION,{operation:"setPollingInterval"})}},{key:"polling",set:function(e){e&&dn.throwError("cannot set polling on WebSocketProvider",f.Logger.errors.UNSUPPORTED_OPERATION,{operation:"setPolling"})}}]),r}($t)},mn=function(){function e(e){this.token_code=e}return e.prototype.serialize=function(e){this.token_code.serialize(e)},e.deserialize=function(r){return new e(Pn.deserialize(r))},e}(),gn=function(){function e(e){this.value=e}return e.prototype.serialize=function(e){xn.serializeArray16U8Array(this.value,e)},e.deserialize=function(r){return new e(xn.deserializeArray16U8Array(r))},e}(),yn=function(){function e(e,r,t,n){this.block_number=e,this.block_reward=r,this.gas_fees=t,this.miner=n}return e.prototype.serialize=function(e){e.serializeU64(this.block_number),e.serializeU128(this.block_reward),e.serializeU128(this.gas_fees),this.miner.serialize(e)},e.deserialize=function(r){return new e(r.deserializeU64(),r.deserializeU128(),r.deserializeU128(),gn.deserialize(r))},e}(),_n=function(){function e(e,r){this.amount=e,this.token_code=r}return e.prototype.serialize=function(e){e.serializeU128(this.amount),this.token_code.serialize(e)},e.deserialize=function(r){return new e(r.deserializeU128(),Pn.deserialize(r))},e}(),wn=function(){function e(e,r,t){this.amount=e,this.token_code=r,this.metadata=t}return e.prototype.serialize=function(e){e.serializeU128(this.amount),this.token_code.serialize(e),xn.serializeVectorU8(this.metadata,e)},e.deserialize=function(r){return new e(r.deserializeU128(),Pn.deserialize(r),xn.deserializeVectorU8(r))},e}(),zn=function(){function e(e,r){this.amount=e,this.token_code=r}return e.prototype.serialize=function(e){e.serializeU128(this.amount),this.token_code.serialize(e)},e.deserialize=function(r){return new e(r.deserializeU128(),Pn.deserialize(r))},e}(),bn=function(){function e(e,r,t,n){this.number=e,this.author=r,this.timestamp=t,this.uncles=n}return e.prototype.serialize=function(e){e.serializeU64(this.number),this.author.serialize(e),e.serializeU64(this.timestamp),e.serializeU64(this.uncles)},e.deserialize=function(r){return new e(r.deserializeU64(),gn.deserialize(r),r.deserializeU64(),r.deserializeU64())},e}(),kn=function(){function e(e,r){this.proposal_id=e,this.proposer=r}return e.prototype.serialize=function(e){e.serializeU64(this.proposal_id),this.proposer.serialize(e)},e.deserialize=function(r){return new e(r.deserializeU64(),gn.deserialize(r))},e}(),Pn=function(){function e(e,r,t){this.address=e,this.module=r,this.name=t}return e.prototype.serialize=function(e){this.address.serialize(e),e.serializeStr(this.module),e.serializeStr(this.name)},e.deserialize=function(r){return new e(gn.deserialize(r),r.deserializeStr(),r.deserializeStr())},e}(),En=function(){function e(e,r,t,n,i){this.proposal_id=e,this.proposer=r,this.voter=t,this.agree=n,this.vote=i}return e.prototype.serialize=function(e){e.serializeU64(this.proposal_id),this.proposer.serialize(e),this.voter.serialize(e),e.serializeBool(this.agree),e.serializeU128(this.vote)},e.deserialize=function(r){return new e(r.deserializeU64(),gn.deserialize(r),gn.deserialize(r),r.deserializeBool(),r.deserializeU128())},e}(),Tn=function(){function e(e,r,t){this.amount=e,this.token_code=r,this.metadata=t}return e.prototype.serialize=function(e){e.serializeU128(this.amount),this.token_code.serialize(e),xn.serializeVectorU8(this.metadata,e)},e.deserialize=function(r){return new e(r.deserializeU128(),Pn.deserialize(r),xn.deserializeVectorU8(r))},e}(),xn=function(){function e(){}return e.serializeArray16U8Array=function(e,r){e.forEach(function(e){r.serializeU8(e[0])})},e.deserializeArray16U8Array=function(e){for(var r=[],t=0;t<16;t++)r.push([e.deserializeU8()]);return r},e.serializeVectorU8=function(e,r){r.serializeLen(e.length),e.forEach(function(e){r.serializeU8(e)})},e.deserializeVectorU8=function(e){for(var r=e.deserializeLen(),t=[],n=0;n<r;n++)t.push(e.deserializeU8());return t},e}(),In={__proto__:null,AcceptTokenEvent:mn,AccountAddress:gn,BlockRewardEvent:yn,BurnEvent:_n,DepositEvent:wn,MintEvent:zn,NewBlockEvent:bn,ProposalCreatedEvent:kn,TokenCode:Pn,VoteChangedEvent:En,WithdrawEvent:Tn,Helpers:xn};Pn.prototype.toJS=function(){return{address:Cr(this.address),module:this.module,name:this.name}},wn.prototype.toJS=function(){return{amount:this.amount,metadata:this.metadata,token_code:this.token_code.toJS()}},mn.prototype.toJS=function(){return{token_code:this.token_code.toJS()}},yn.prototype.toJS=function(){return{block_number:this.block_number,block_reward:this.block_reward,gas_fees:this.gas_fees,miner:Cr(this.miner)}},_n.prototype.toJS=function(){return{amount:this.amount,token_code:this.token_code.toJS()}},zn.prototype.toJS=function(){return{amount:this.amount,token_code:this.token_code.toJS()}},bn.prototype.toJS=function(){return{number:this.number,author:Cr(this.author),timestamp:this.timestamp,uncles:this.uncles}},kn.prototype.toJS=function(){return{proposal_id:this.proposal_id,proposer:Cr(this.proposer)}},En.prototype.toJS=function(){return{agree:this.agree,vote:this.vote,voter:Cr(this.voter),proposal_id:this.proposal_id,proposer:Cr(this.proposer)}},Tn.prototype.toJS=function(){return{amount:this.amount,metadata:this.metadata,token_code:this.token_code.toJS()}},wn.prototype.toJS=function(){return{amount:this.amount,metadata:this.metadata,token_code:this.token_code.toJS()}};var Bn={__proto__:null,decodeEventKey:function(e){var r=t.arrayify(e);if(24!==r.byteLength)throw new Error("invalid eventkey data, expect byte length to be 24, actual: "+r.byteLength);var n=r.slice(0,8),i=Buffer.from(n),o=_.readBigUInt64LE(i);return{address:Ir(r.slice(8)),salt:o}},decodeEventData:function(e,r){return Ar(In[e],r)}};e.bcs=L,e.crypto_hash=xr,e.encoding=Wr,e.onchain_events=Bn,e.providers=vn,e.serde=un,e.starcoin_types=_r,e.types=O,e.utils=sn,e.version=ut});
//# sourceMappingURL=starcoin.umd.js.map
